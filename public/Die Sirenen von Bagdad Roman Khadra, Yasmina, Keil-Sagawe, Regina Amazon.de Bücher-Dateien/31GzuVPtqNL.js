'use strict';mix_d("AuthorCards__follow-the-author-card:follow-the-author-card__-1ag2TGg","exports tslib @c/scoped-dom @c/browser-operations @c/dom @c/remote-operations @c/metrics @c/tracking @p/A @p/a-modal @p/a-popover @p/jQuery @c/navigation".split(" "),function(m,n,r,C,D,E,F,x,G,H,I,J,K){function g(a){return a&&"object"===typeof a&&"default"in a?a:{"default":a}}var p=g(r),L=g(C),y=g(D),z=g(E),M=g(F),q=g(G),N=g(H),O=g(I),P=g(J);r=g(K);var l,d=function(){function a(){}a.MORE_ABOUT_THE_AUTHOR_SECTION_REFERENCE=
"books-entity-teaser";a.SIMILAR_AUTHORS_NUMBER=3;a.MAX_NUMBER_OF_AUTHORS=2;a.MAX_IMAGE_HEIGHT=600;a.ADDITIONAL_AUTHORS_NAMES=2;a.MAX_PRODUCT_API_BATCH_SIZE=30;a.AUTHOR_PAGE_URL="authorPageUrl";a.CONTRIBUTOR_PAGE_URL="contributorLinkUrl";a.SEARCH_PAGE_URL="searchPageUrlFromConfig";a.AUTHOR_PROFILE_IMAGE="authorProfileImage";a.CUSTOMER_REVIEWS_DP_ANCHOR="#customerReviews";a.DISPLAY_TEXT="displayText";a.FOLLOW_TEXT="followText";a.FOLLOWING_TEXT="followingText";a.TOOLTIP_TEXT="tooltipText";a.SIMILAR_AUTHORS_POPOVER_ID=
"similarAuthorsPopoverId";a.SIMILAR_AUTHORS_POPOVER_CONTENT_NAME="similarAuthorsPopoverContentName";a.NEXUS_PRODUCER_ID="author-follows";a.NEXUS_PROMPT_SCHEMA_ID="authorfollow.prompts.2";a.AUTHOR_PROMPTS_CARD_ID="author-prompts-card";a.TEXT_TICK="\u2713";a.TEXT_PLUS="+";a.PLACEMENT_FTA="FTA";a.PLACEMENT_POPOVER="POPOVER";a.PLACEMENT_MATA="MATA";a.PLACEMENT_MATA_MOBILE="MATA_MOBILE";a.PLACEMENT_TYP="TYP";a.PLACEMENT_AUTHOR_PAGE="ap";a.CSS_CLASS_FOLLOW="follow";a.CSS_CLASS_FOLLOW_T1="followT1";a.CSS_CLASS_SIMILAR_AUTHORS=
"similarAuthorsFollow";a.CSS_CLASS_MATA_MOBILE="followButtonMobile";a.CSS_CLASS_TYP="fullWidth";a.CSS_CLASS_MATA="followMata";a.CSS_CLASS_MATA_T1="followMataT1";a.DATA="data";a.DATA_AUTHOR_ASIN="data-authorasin";a.DATA_FOLLOWING="data-followingtext";a.DATA_FOLLOW="data-followtext";a.DATA_REFTAG="data-reftag";a.DATA_FOLLOW_REF="data-followref";a.DATA_UNFOLLOW_REF="data-unfollowref";a.DATA_SIMILAR_POPOVER="data-similarauthorspopoverid";a.DATA_SIMILAR_POPOVER_CONTENT="data-similarauthorspopovercontentname";
a.DATA_SIGNEDIN="data-issignedin";a.DATA_IS_FOLLOWING="data-isfollowing";a.DATA_SYNCED="data-synced";a.DATA_FOLLOW_BUTTON_TOTAL_WIDTH="data-followbuttontotalwidth";a.DEFAULT_ORG_UNIT="01";a.MARKETPLACE_ORG_UNIT={A13V1IB3VIYZZH:"08",A1AM78C64UM0Y8:"33",A1F83G8C2ARO7P:"02",A1PA6795UKMFR9:"03",A1RKKUPIHCS9HS:"30",A1VC38T7YXB528:"09",A21TJRUUN4KGV:"31",A2EUQ1WTGCTBG2:"15",A2Q3Y263D00KWC:"32",A39IBJ37TRP1C6:"35",APJ6JRA9NG5V4:"29",ATVPDKIKX0DER:a.DEFAULT_ORG_UNIT};a.PLACEMENTS_TO_CLASSES_MAP=(l={},l[a.PLACEMENT_FTA]=
a.CSS_CLASS_FOLLOW,l[a.PLACEMENT_POPOVER]=a.CSS_CLASS_SIMILAR_AUTHORS,l[a.PLACEMENT_MATA]=a.CSS_CLASS_MATA,l[a.PLACEMENT_MATA_MOBILE]=a.CSS_CLASS_MATA_MOBILE,l[a.PLACEMENT_TYP]=a.CSS_CLASS_TYP,l);a.DEFAULT_FOLLOW_BUTTON_WIDTH=95;a.LANGUAGE_TO_FOLLOW_BUTTON_WIDTH_MAP=new Map([["es-ES",97],["es-US",97],["es-MX",97],["fr-FR",72],["fr-CA",89],["de-DE",85],["pt-PT",85],["pt-BR",93],["it-IT",97],["he-IL",61],["tr-TR",116],["pl-PL",118],["cs-CZ",86],["ml-IN",107],["te-IN",139],["hi-IN",108],["ta-IN",106],
["kn-IN",137],["bn-IN",78],["mr-IN",83],["ja-JP",103],["zh-CN",90],["ar-AE",66],["zh-TW",60],["ko-KR",57],["nl-NL",79],["sv-SE",71]]);return a}(),h=r["default"].getLocation(),Q=h.protocol+"//"+h.hostname+(h.port?":"+h.port:"")+"/ap/signin",R=/^(?:(?:(?:(\w\w)-)?pre-prod)|(?:.+))\.amazon.(?:(\w\w)|(com)|(?:co\.(?:(\w\w)))|(?:com\.(?:(\w\w))))?$/,A={au:"A39IBJ37TRP1C6",br:"A2Q3Y263D00KWC",ca:"A2EUQ1WTGCTBG2",com:"ATVPDKIKX0DER",de:"A1PA6795UKMFR9",es:"A1RKKUPIHCS9HS",fr:"A13V1IB3VIYZZH",in:"A21TJRUUN4KGV",
it:"APJ6JRA9NG5V4",jp:"A1VC38T7YXB528",mx:"A1AM78C64UM0Y8",uk:"A1F83G8C2ARO7P"},S={A13V1IB3VIYZZH:"author_follows_dp_fr",A1AM78C64UM0Y8:"author_follows_dp_mx",A1F83G8C2ARO7P:"author_follows_dp_uk",A1PA6795UKMFR9:"author_follows_dp_de",A1RKKUPIHCS9HS:"author_follows_dp_es",A1VC38T7YXB528:"author_follows_dp_jp",A21TJRUUN4KGV:"author_follows_dp_in",A2EUQ1WTGCTBG2:"author_follows_dp_ca",A2Q3Y263D00KWC:"author_follows_dp_br",A39IBJ37TRP1C6:"author_follows_dp_au",APJ6JRA9NG5V4:"author_follows_dp_it",ATVPDKIKX0DER:"author_follows_dp_us"},
T=function(a){var b;a:if(b=h.hostname.match(R)){for(var c=1;c<b.length;c++)if(void 0!==b[c]){b=void 0!==A[b[c]]?A[b[c]]:"ATVPDKIKX0DER";break a}b=void 0}else b="ATVPDKIKX0DER";return Q.replace(/^https?:\/\//,"https://")+"?openid.assoc_handle="+S[b]+"&openid.claimed_id="+encodeURIComponent("http://specs.openid.net/auth/2.0/identifier_select")+"&openid.identity="+encodeURIComponent("http://specs.openid.net/auth/2.0/identifier_select")+"&openid.mode=checkid_setup&openid.ns="+encodeURIComponent("http://specs.openid.net/auth/2.0")+
"&openid.ns.pape="+encodeURIComponent("http://specs.openid.net/extensions/pape/1.0")+"&openid.pape.max_auth_age=0&openid.return_to="+encodeURIComponent("https://"+h.hostname+h.pathname+((h.search?h.search+"&":"?")+("author-follow="+a)))},B=function(){function a(a,c){this.buttonPlacement=a;this.operationProxy=c;this.reftag=""}a.prototype.enableButtonColumns=function(a){for(var b=0;b<a.length;b++)this.setFollowStatus(a.item(b),b)};a.prototype.setAutoFollowEnabled=function(a){void 0!==sessionStorage&&
(a=a.getAttribute(d.DATA_AUTHOR_ASIN),sessionStorage.followKey=a)};a.prototype.isAutoFollowEnabled=function(a){a=a.getAttribute(d.DATA_AUTHOR_ASIN);var b=h.search.match("author-follow=([^#&]+)");if((b&&2===b.length?b[1]:void 0)!==a||"undefined"===typeof sessionStorage)return!1;b=sessionStorage.followKey;sessionStorage.removeItem("followKey");return b===a};a.prototype.checkIsFollowing=function(a){return"true"===a.getAttribute(d.DATA_IS_FOLLOWING)};a.prototype.updateFollowButtonText=function(a,c){c?
(c=a.getAttribute(d.DATA_FOLLOWING),a.innerText=null!==c?c:d.TEXT_TICK):(c=a.getAttribute(d.DATA_FOLLOW),a.innerText=null!==c?c:d.TEXT_PLUS)};a.prototype.setFollowStatus=function(a,c){var b=this;if(null===a.getAttribute(d.DATA_SYNCED)){a.setAttribute(d.DATA_SYNCED,"true");var f=a.getAttribute(d.DATA_AUTHOR_ASIN),k=a.getAttribute(d.DATA_REFTAG);this.reftag=k?k:this.reftag;this.getOperationProxy().getFollowStatus({authorAsin:f,index:c,placement:this.buttonPlacement,reftag:this.reftag}).then(function(c){a.className=
a.className.split(" ").filter(function(a){return!a.includes("spinner")}).join(" ");a.innerHTML=c.outerHTML;c=a.getElementsByClassName("author-follow-button")[0];b.bindOperationsToButton(c,f)})}};a.prototype.bindOperationsForAllButtons=function(a){var b=this;a.forEach(function(a){b.bindOperationsToButton(a,a.getAttribute(d.DATA_AUTHOR_ASIN))})};a.prototype.bindOperationsToButton=function(a,c){var b=this;a.getAttribute("href")?(a.setAttribute("href",T(c)),a.onclick=function(){b.setAutoFollowEnabled(a)}):
(!this.checkIsFollowing(a)&&this.isAutoFollowEnabled(a)&&this.executeFollow(a),a.onclick=function(){b.checkIsFollowing(a)?b.executeUnfollow(a):b.executeFollow(a)})};a.prototype.executeUnfollow=function(a){var b=this,e,f=null!==(e=a.getAttribute(d.DATA_UNFOLLOW_REF))&&void 0!==e?e:"",k=a.getAttribute(d.DATA_AUTHOR_ASIN);x.addTracking(this.getOperationProxy().executeUnfollow,{ref_:f})({authorAsin:k}).then(function(c){b.publishDataToNexus("RemoveFavorite",k,f,c);b.updateFollowButtonText(a,!1);a.setAttribute(d.DATA_IS_FOLLOWING,
"false")}).catch(function(){b.showErrorModal()})};a.prototype.executeFollow=function(a){var b=this,e,f=null!==(e=a.getAttribute(d.DATA_FOLLOW_REF))&&void 0!==e?e:"",k=a.getAttribute(d.DATA_AUTHOR_ASIN);x.addTracking(this.getOperationProxy().executeFollow,{ref_:f})({authorAsin:k}).then(function(c){b.publishDataToNexus("AddFavorite",k,f,c);b.updateFollowButtonText(a,!0);a.setAttribute(d.DATA_IS_FOLLOWING,"true");b.showSimilarAuthorsPopover(a)}).catch(function(){b.showErrorModal()})};a.prototype.getOperationProxy=
function(){return this.operationProxy};a.prototype.showSimilarAuthorsPopover=function(a){var b=this,e;if(null!==a.getAttribute(d.DATA_SIMILAR_POPOVER)&&null!==a.getAttribute(d.DATA_SIMILAR_POPOVER_CONTENT)){var f=Number(null===(e=a.getAttribute(d.DATA_SIMILAR_POPOVER))||void 0===e?void 0:e.split("_")[1]);this.getOperationProxy().getRecommendedAuthors({authorAsin:a.getAttribute(d.DATA_AUTHOR_ASIN),index:f,reftag:this.reftag}).then(function(c){if(0<c.innerHTML.length){var e=a.closest(".a-button");null===
e||void 0===e?void 0:e.insertAdjacentHTML("afterend",c.innerHTML);c=y["default"].cardRoot.ownerDocument.querySelectorAll("[class*=authorFollowColumn]");b.buttonPlacement=d.PLACEMENT_POPOVER;b.enableButtonColumns(c);P["default"].when("a-popover").then(function(){var b,c=null!==(b=a.getAttribute(d.DATA_SIMILAR_POPOVER))&&void 0!==b?b:"";O["default"].get(q["default"].$("#"+c)).show()})}})}};a.prototype.showErrorModal=function(){var a=q["default"].$("#followErrorPopoverTrigger"),c=N["default"].create(a,
{closeButton:!1,hideHeader:!0,name:"followErrorPopover",popoverLabel:"followErrorPopover"});q["default"].declarative("closeErrorDialog","click",function(){c.hide()});c.show()};a.prototype.publishDataToNexus=function(a,c,e,f){a=n.__assign({eventType:a,entityType:"author",entityId:c,signedIn:!0,reftag:e},f);M["default"].event(a,d.NEXUS_PRODUCER_ID,"PIM.FollowEvent.7")};return a}(),U=function(a){return n.__awaiter(void 0,void 0,void 0,function(){var b;return n.__generator(this,function(c){c=b=z["default"].setup();
var d=y["default"].cardRoot.querySelectorAll("[class*=followButtonColumn]");(new B(a,c)).enableButtonColumns(d);return[2]})})},V=function(a,b){return n.__awaiter(void 0,void 0,void 0,function(){var c,d;return n.__generator(this,function(e){c=z["default"].setup();d=new B(a,c);d.bindOperationsForAllButtons(b);return[2]})})};m.MyOps=void 0;(function(a){a.adaptAuthorsList="adaptAuthorsList";a.updateAuthorNameWidth="updateAuthorNameWidth"})(m.MyOps||(m.MyOps={}));var t=function(a,b,c,d,f,k,g){a.offsetWidth-
b.offsetWidth-24<c?(d.style.display="none",f&&(b.style.display="inline")):(d.style.display="inline",k.style.width=g+"px",f&&(b.style.display="none"))};m._operationNames=["getFollowStatus","executeFollow","executeUnfollow","getRecommendedAuthors"];m.adaptAuthorsList=t;m.card=function(){return n.__awaiter(void 0,void 0,void 0,function(){var a,b,c,e,f,k,g,h,l,r,q,u,v,w;return n.__generator(this,function(n){a=p["default"].cardRoot.querySelectorAll("[class*=author-follow-button]");0<a.length?V(d.PLACEMENT_FTA,
a):U(d.PLACEMENT_FTA);b=L["default"].setup().define;if(c=p["default"].cardRoot.getElementsByClassName("_follow-the-author-card_styleDpEvoUX_authorNameSection__1hRZG")[0])e=c.offsetWidth+1,b(m.MyOps.updateAuthorNameWidth,"resize",function(a){c.style.width=e+"px"});if(f=p["default"].cardRoot.getElementsByClassName("_follow-the-author-card_styleDpEvoUX_authorToHide__2zNbX")[0])k=p["default"].cardRoot.getElementsByClassName("_follow-the-author-card_styleDpEvoUX_cardContainer__3fldR")[0],g=p["default"].cardRoot.getElementsByClassName("_follow-the-author-card_styleDpEvoUX_firstAuthor__3kHne")[0],
h=p["default"].cardRoot.getElementsByClassName("_follow-the-author-card_styleDpEvoUX_rightLinkSection__3jH54")[0],l=p["default"].cardRoot.getElementsByClassName("_follow-the-author-card_styleDpEvoUX_authorNameSection__1hRZG")[1],r=+(null!==(w=k.getAttribute(d.DATA_FOLLOW_BUTTON_TOTAL_WIDTH))&&void 0!==w?w:d.DEFAULT_FOLLOW_BUTTON_WIDTH),q=g.offsetWidth+f.offsetWidth+r-68,u=l.offsetWidth+1,v=0===h.offsetWidth,t(k,h,q,f,v,l,u),b(m.MyOps.adaptAuthorsList,"resize",function(a){t(k,h,q,f,v,l,u)});return[2]})})}});
