/*! For license information please see 3.dc2e34c067f14b93135b.chunk.min.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{211:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=function(e,t){return e.replace(/\${([a-zA-Z]+)}/g,(function(e,n){return t[n]||""}))}},225:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return u})),n.d(t,"c",(function(){return d})),n.d(t,"d",(function(){return f})),n.d(t,"e",(function(){return b}));var r=n(15),o=n(61),a=n(39),i=function(e){return e||window},c=function(e){return e&&e.clientWidth?e.clientWidth:r.g()},l=function(e){return e&&e.clientHeight?e.clientHeight:window.innerHeight},s=function(e){return e?e.getBoundingClientRect().top:0},u=function(){var e=r.g(),t=document.querySelector(".right-sidebar");return e>=o.a?0:e>=o.d&&t?t.clientHeight:0},d=function(e){return{height:l(e)-u(),width:c(e),topOffset:s(e)+u()+(t=document.querySelector(".book-title-overlay-container"),t&&t.clientHeight?t.clientHeight:0)};var t},f=function(){var e=document.getElementById(a.r);e&&(e.style.opacity="0")},b=function(){var e=document.getElementById(a.r);e&&(e.style.opacity="1")}},240:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=function(e,t){var n=e;t&&n.addEventListener("click",t(n.href))}},257:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(0),o=n(121),a=function(){var e=Object(r.useContext)(o.b),t=e.state,n=e.dispatch;return{lastPositionRead:t.lastPositionRead,setLastPositionRead:function(e){n({payload:e,type:o.a.SET_LPR})}}}},260:function(e,t,n){"use strict";n.d(t,"a",(function(){return Ne}));var r,o=n(4),a=n(0),i=n(44),c=n(53),l=n(15),s=n(282),u=n(396),d=n(397),f=n(255),b=n(398),m=n(284),p=n.n(m),O=n(402),h=n(72),g=function(){return a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"34",height:"34",viewBox:"0 0 25 25"},a.createElement("g",{fill:"none",fillRule:"evenodd"},a.createElement("rect",{width:"24",height:"24",x:".5",y:".5",fill:"#2F3841",stroke:"#000",strokeOpacity:".25",rx:"3"}),a.createElement("path",{fill:"#FFF",d:"M10.5731534,21 L8.32715569,19.4064036 L5.07872501,13.8627847 C4.91871516,13.5897194 5.0103647,13.2386426 5.28342997,13.0786328 C5.37130122,13.0271423 5.47130734,13 5.57315343,13 L5.74472631,13 C6.27515929,13 6.78386711,13.2107137 7.15893987,13.5857864 L9.57315343,16 L9.57315343,16 L9.57315343,7 C9.57315343,6.44771525 10.0208687,6 10.5731534,6 C11.1254382,6 11.5731534,6.44771525 11.5731534,7 L11.573,12.222 L17.683585,12.9011591 C18.1900176,12.9574294 18.5731534,13.3854936 18.5731534,13.8950428 L18.5731534,17.7625493 C18.5731534,18.5606158 18.2551651,19.3257906 17.6895366,19.8887954 L17.4509793,20.1262461 C16.8887764,20.6858411 16.1278292,21 15.3345962,21 L10.5731534,21 Z"}),a.createElement("path",{stroke:"#FFF",strokeDasharray:"1.333 2.667",strokeWidth:"2",d:"M6,2 C8.209139,2 10,3.790861 10,6 C10,8.209139 8.209139,10 6,10 C3.790861,10 2,8.209139 2,6 C2,3.790861 3.790861,2 6,2 Z",opacity:".6",transform:"rotate(174 8.224 6.618)"})))},v=function(){return a.createElement("svg",{width:"34px",height:"34px",viewBox:"0 0 25 25"},a.createElement("g",{id:"Symbols-play",stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},a.createElement("g",{id:"button-/-buy-now-/-normal",transform:"translate(-3.000000, -3.000000)"},a.createElement("g",{id:"Group",transform:"translate(3.000000, 3.000000)"},a.createElement("rect",{id:"container",strokeOpacity:"0.25",stroke:"#000000",fill:"#2F3841",x:"0.5",y:"0.5",width:"24",height:"24",rx:"3"}),a.createElement("polygon",{id:"Page-1",fill:"#FFFFFF",transform:"translate(13.500000, 13.000000) scale(-1, 1) translate(-13.500000, -13.000000) ",points:"15.8420002 8 10 13 15.8420002 18 17 18 17 8"})))))},k=function(){return a.createElement("svg",{width:"34px",height:"34px",viewBox:"0 0 25 25"},a.createElement("g",{id:"Symbols",stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},a.createElement("g",{id:"Group"},a.createElement("rect",{id:"container",strokeOpacity:"0.25",stroke:"#000000",fill:"#2F3841",x:"0.5",y:"0.5",width:"24",height:"24",rx:"3"}),a.createElement("path",{d:"M18.3729813,18.5932836 C19.0551888,18.5932836 19.5952698,19.125 19.5952698,19.7966418 C19.5952698,20.4682836 19.0551888,21 18.3729813,21 C17.6907737,21 17.1506927,20.4682836 17.1506927,19.7966418 C17.1506927,19.125 17.6907737,18.5932836 18.3729813,18.5932836 Z M10.4991691,18.5932836 C11.1529513,18.5932836 11.7214576,19.125 11.7214576,19.7966418 C11.7214576,20.4682836 11.1813766,21 10.4991691,21 C9.84538686,21 9.30530588,20.4682836 9.30530588,19.7966418 C9.30530588,19.125 9.84538686,18.5932836 10.4991691,18.5932836 Z M5.96358768,6 L10.565,15.75 L18.4936837,15.75 L21.325084,9.75 L23,9.75 L19.4607496,17.25 L9.58994696,17.25 L9.589,17.233 L4.99652178,7.5 L2,7.5 L2,6 L5.96358768,6 Z M13.7644178,12.75 L13.7644178,14.25 L12.2464284,14.25 L12.2464284,12.75 L13.7644178,12.75 Z M16.8003966,12.75 L16.8003966,14.25 L15.2824072,14.25 L15.2824072,12.75 L16.8003966,12.75 Z M11.866931,9.75 L11.866931,11.25 L10.3489417,11.25 L10.3489417,9.75 L11.866931,9.75 Z M15.2824072,9.75 L15.2824072,11.25 L13.7644178,11.25 L13.7644178,9.75 L15.2824072,9.75 Z M18.6978833,9.75 L18.6978833,11.25 L17.1798939,11.25 L17.1798939,9.75 L18.6978833,9.75 Z",id:"icon-/-cart-empty",fill:"#FFFFFF"}))))},E=n(403),w=n(56),y=n(76),S=n(117),R=n(78),T=function(e,t,n){var r="buy-button";switch(e){case c.d.BUY:r+=n?" add-to-cart-button":t?" glide-buy-button-clicked":" glide-buy-button";break;case c.d.BORROW:r+=t?" glide-buy-button-clicked":" glide-add-to-library-button";break;case c.d.PREORDER:r+=" preorder-button";break;case c.d.SAMPLE:r+=" sample-button"}return r},j=function(e){Object(a.useEffect)((function(){return r(E.b.RENDER)}),[e.asin]);var t=Object(y.a)(),n=Object(w.a)().getLitbTranslation,r=(Object(R.a)().isWeblabEnabled,function(t){if(e.actionType!==c.d.BUY)e.recordCountMetric(E.a+"::"+e.actionType.toUpperCase()+"::"+t,1);else if(e.buttonIcon===c.c.CART)e.recordCountMetric(E.a+"::AddToCart::"+t,1);else{var n=Object(i.b)(e.actionType,e.actionProgramCode);e.recordCountMetric(E.a+"::"+n.toUpperCase()+"::"+t,1)}});return a.createElement(a.Fragment,null,a.createElement("button",{onClick:function(){var n=Object(i.b)(e.actionType,e.actionProgramCode),o=Object(i.a)(e.refTagPrefix,n);t.emitInBookAction({action:e.actionType+"Click",context:"BuyBox",value:""}),r(E.b.CLICK),e.handleAcquisition?(e.recordCountMetric&&e.recordCountMetric("LITB::Acquisition::Method::HandleAcquisition",1),e.handleAcquisition()):e.inlineBiFrost?(e.recordCountMetric("LITB::Acquisition::Method::InlineBiFrost",1),e.setIsProcessing(!0),Object(c.g)(e.glideClientId,e.acquisitionUrl,e.csrfToken,e.actionId,o).then((function(t){e.handleInlineAcquisition&&e.handleInlineAcquisition(t)})).catch((function(t){e.handleInlineAcquisition&&e.handleInlineAcquisition({httpStatusCode:500,status:t.message})}))):e.isPhysicalItem&&e.offerListingId?(e.recordCountMetric("LITB::Acquisition::Method::AddToCart",1),Object(c.h)(e.acquisitionUrl,e.asin,e.offerListingId,e.sessionId,o,Object(S.b)("cart-add-amzn-csrf"))):(e.recordCountMetric("LITB::Acquisition::Method::FormAcquisition",1),Object(c.f)(e.glideClientId,e.acquisitionUrl,e.csrfToken,e.actionId,o,e.actionType))},className:T(e.actionType,e.isProcessing,e.buttonIcon===c.c.CART),id:"side-bar-buy-button","aria-label":e.ariaLabel,disabled:e.isProcessing},e.isProcessing?a.createElement("span",{className:"buy-box-loader"}):function(){var t;switch(e.buttonIcon){case c.c.CART:t=a.createElement(k,null);break;case c.c.HAND:t=a.createElement(g,null);break;case c.c.PLAY:t=a.createElement(v,null)}return t&&e.showIcon?a.createElement("i",{className:"buy-button-icon"},t):null}(),e.isProcessing?n("kw-litb-book-purchasing"):e.buttonName))},C=n(404),I=n(257),M=n(2),N=n(120),L=n(211),P=n(37),_=n(3),A=n(17),x=function(e){var t=Object(w.a)().getLitbTranslation;return Object(a.useEffect)((function(){return Object(_.recordCountMetric)(A.a.BUYING_OFFERS_RENDER,1)}),[]),a.createElement(a.Fragment,null,a.createElement("p",{className:"all-buying-offers",dangerouslySetInnerHTML:{__html:Object(L.a)(t("kw-litb-offers-available"),{count:e.usedAndNewCount.toString(),offer:1===e.usedAndNewCount?t("kw-litb-offer"):t("kw-litb-offers"),price:e.usedAndNewLowestPrice})}}),a.createElement("a",{className:"all-buying-offers-button",target:"_parent",rel:"noreferrer noopener",href:e.usedAndNewOfferUrl},t("kw-litb-see-buying-options")))},D=function(e){var t=Object(w.a)().getLitbTranslation;Object(a.useEffect)((function(){return Object(_.recordCountMetric)(A.a.NOT_SUPPORTED_RENDER,1)}),[e.bookTitle]);var n=Object(L.a)(t("kw-litb-unsupported-available-at"),{countryName:e.countryName,countryBaseUrl:e.countryBaseUrl}),r=e.searchUrl+"&field-keywords="+e.bookTitle;return a.createElement(a.Fragment,null,a.createElement("span",{className:"unsupported-button"},n),a.createElement("br",null),a.createElement("a",{className:"unsupported-button",target:"_parent",rel:"noreferrer noopener",href:r},Object(L.a)(t("kw-litb-unsupported-continue-shopping"),{countryBaseUrl:e.countryBaseUrl})))},z=n(5),B=function(e){var t=i.a(e.refTagPrefix,"rb"),n=i.c(e.readNowUrl,t),r=i.a(e.refTagPrefix,"rb_new_exp");Object(a.useEffect)((function(){Object(_.recordCountMetric)(A.a.READ_NOW_RENDER,1)}),[]);return a.createElement("button",{className:"read-now-button",onClick:function(){window.location.href.includes("#S2F")?Object(_.recordCountAndUploadMetric)(A.a.READ_NOW_S2F_CLICK,1):(n=Object(z.b)(n,"ref",r),Object(_.recordCountAndUploadMetric)(A.a.READ_NOW_CLICK,1)),parent.location.href=n}},e.buyButtonLabel)},U=function(e){var t,n=Object(w.a)().getLitbTranslation;Object(a.useEffect)((function(){return Object(_.recordCountMetric)(A.a.PROCEED_TO_CART_RENDER,1)}),[e.redirectUrl]);var r,o=e.itemCount>1?"kw-litb-items":"kw-litb-item";return(null===(t=e.interactionManager)||void 0===t?void 0:t.anchorOnClick)&&(r=e.interactionManager.anchorOnClick(e.redirectUrl)),a.createElement("a",{href:i.c(e.redirectUrl,i.a(e.refTagPrefix,"proc")),onClick:r,className:"proceed-to-cart-button"},Object(L.a)(n("kw-litb-proceed-to-cart"),{itemCount:e.itemCount.toString(),items:n(o)}))},F=new Map([["www.amazon.com","read.amazon.com"],["www.amazon.co.jp","read.amazon.co.jp"],["www.amazon.fr","lire.amazon.fr"],["www.amazon.com","read.amazon.com"],["www.amazon.co.jp","read.amazon.co.jp"],["www.amazon.fr","lire.amazon.fr"],["www.amazon.ca","read.amazon.ca"],["www.amazon.in","read.amazon.in"],["www.amazon.co.uk ","read.amazon.co.uk"],["www.amazon.de","lesen.amazon.de"],["www.amazon.cn","read.amazon.cn"],["www.amazon.com.br","ler.amazon.com.br"],["www.amazon.com.mx","leer.amazon.com.mx"],["www.amazon.com.au","read.amazon.com.au"],["www.amazon.es","leer.amazon.es"],["www.amazon.it","leggi.amazon.it"],["www.amazon.nl","lezen.amazon.nl"],["pre-prod.amazon.com","pread-preprod.amazon.com"],["jp-pre-prod.amazon.com","read-pre-prod-jp.amazon.com"],["fr-pre-prod.amazon.com","read-pre-prod-fr.amazon.com"],["ca-pre-prod.amazon.com","read-pre-prod-ca.amazon.com"],["in-pre-prod.amazon.com","read-pre-prod-in.amazon.com"],["uk-pre-prod.amazon.com","read-preprod.amazon.co.uk"],["de-pre-prod.amazon.com","read-pre-prod-de.amazon.com"],["cn-pre-prod.amazon.com","read-pre-prod-cn.amazon.com"],["br-pre-prod.amazon.com","read-pre-prod-br.amazon.com"],["mx-pre-prod.amazon.com","read-pre-prod-mx.amazon.com"],["au-pre-prod.amazon.com","read-pre-prod-au.amazon.com"],["es-pre-prod.amazon.com","read-pre-prod-es.amazon.com"],["it-pre-prod.amazon.com","read-pre-prod-it.amazon.com"],["nl-pre-prod.amazon.com","lezen-nl-preprod.dub.xcorp.amazon.com"]]),H=new Map([["read.amazon.com","www.amazon.com"],["read.amazon.co.jp","www.amazon.co.jp"],["lire.amazon.fr"," www.amazon.fr"],["read.amazon.com","www.amazon.com"],["read.amazon.co.jp","www.amazon.co.jp"],["lire.amazon.fr","www.amazon.fr"],["read.amazon.ca","www.amazon.ca"],["read.amazon.in","www.amazon.in"],["read.amazon.co.uk","www.amazon.co.uk"],["lesen.amazon.de","www.amazon.de"],["read.amazon.cn","www.amazon.cn"],["ler.amazon.com.br","www.amazon.com.br"],["leer.amazon.com.mx","www.amazon.com.mx"],["read.amazon.com.au","www.amazon.com.au"],["leer.amazon.es","www.amazon.es"],["leggi.amazon.it","www.amazon.it"],["lezen.amazon.nl","www.amazon.nl"],["read-preprod.amazon.com","pre-prod.amazon.com"],["read-pre-prod-jp.amazon.com","jp-pre-prod.amazon.com"],["read-pre-prod-fr.amazon.com","fr-pre-prod.amazon.com"],["read-pre-prod-ca.amazon.com","ca-pre-prod.amazon.com"],["read-pre-prod-in.amazon.com","in-pre-prod.amazon.com"],["read-preprod.amazon.co.uk","uk-pre-prod.amazon.com"],["read-pre-prod-de.amazon.com","de-pre-prod.amazon.com"],["read-pre-prod-cn.amazon.com","cn-pre-prod.amazon.com"],["read-pre-prod-br.amazon.com","br-pre-prod.amazon.com"],["read-pre-prod-mx.amazon.com","mx-pre-prod.amazon.com"],["read-pre-prod-au.amazon.com","au-pre-prod.amazon.com"],["read-pre-prod-es.amazon.com","es-pre-prod.amazon.com"],["read-pre-prod-it.amazon.com","it-pre-prod.amazon.com"],["lezen-nl-preprod.dub.xcorp.amazon.com","nl-pre-prod.amazon.com"]]),q=function(e){var t;return null!=(t=H.get(e.hostname))?t:"www.amazon.com"},W=function(e){var t=new URL(e);return function(e){return F.has(e.hostname)}(t)||(e=(e=e.replace(new RegExp(t.hostname,"gi"),q(t))).replace("destinationPath=%2F%2F","destinationPath=%2F")),e},K=function(){var e;return null===(e=document.documentElement.lang)||void 0===e?void 0:e.replace("_","-")},Y=function(e){if(Object(_.recordCountAndUploadMetric)(A.a.BIFROST_SUCCESS,1),e.resources){var t=e.resources[0].states[0].links[0].url;t=W(t),parent.location.href=t}},G=n(9),Q=n(12),Z=n(19),V=n(81),J={headers:{Accept:"application/json","x-amzn-sessionid":V.get("session-id")},credentials:"include"},X=function(e,t,n,r){return new(n||(n=Promise))((function(o,a){function i(e){try{l(r.next(e))}catch(t){a(t)}}function c(e){try{l(r.throw(e))}catch(t){a(t)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,c)}l((r=r.apply(e,t||[])).next())}))},$=function(e,t){var n,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(a){return function(c){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(o=2&a[0]?r.return:a[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,r=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(c){a=[6,c],r=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}},ee=null,te=!1,ne=function(e,t){return void 0===t&&(t=0),X(void 0,void 0,void 0,(function(){var n,r,o,a,i;return $(this,(function(c){switch(c.label){case 0:return null!==ee||te?[3,2]:(n=function(){var e=Q.d+"?serialNumber=A2CTZ977SKFQZY&deviceType=A2CTZ977SKFQZY";return Object(Z.a)(e,J,!1).then((function(e){return e.json()})).then((function(e){return null===e.deviceSessionToken||0===e.deviceSessionToken.length?(Object(_.recordCountMetric)(A.a.NO_DEVICE_TOKEN,1),null):(Object(_.recordCountMetric)(A.a.DEVICE_TOKEN_SUCCESS,1),e.deviceSessionToken)})).catch((function(){return Object(_.recordCountMetric)(A.a.DEVICE_TOKEN_FAILURE,1),Promise.resolve(null)}))}(),l="KFW",s=Q.k+"/?reader="+l,r=Object(Z.a)(s,{},!0).then((function(e){return e.json()})).then((function(e){return e.isValid?Object(_.recordCountMetric)(A.a.VALID_FULL_BOOK_BROWSER+":"+l,1):Object(_.recordCountMetric)(A.a.INVALID_FULL_BOOK_BROWSER+":"+l,1),e.isValid})).catch((function(){return Object(_.recordCountMetric)(A.a.FAILED_FULL_BOOK_BROWSER+":"+l,1),!1})),[4,Promise.all([n,r])]);case 1:i=c.sent(),ee=i[0],te=i[1],c.label=2;case 2:return null!==ee&&te?(o={headers:{Accept:"application/json","x-amzn-sessionid":V.get("session-id"),"x-adp-session-token":ee},credentials:"include"},Object(_.recordCountMetric)(A.a.CAN_START_READING_RETRIES+":"+t,1),a=Q.c+"?asin="+e+"&clientVersion=12000999&isSample=false",[2,Object(Z.a)(a,o,!1).then((function(e){return e.json()})).then((function(n){return!n.canStartReading&&"ContentNotOwned"===n.downloadRestrictionReason.reasonCode&&t<2?new Promise((function(n,r){setTimeout((function(){ne(e,t+1).then(n).catch(r)}),2e3)})):(Object(_.recordCountMetric)(A.a.CAN_START_READING_SUCCESS,1),n.canStartReading)})).catch((function(){return Object(_.recordCountMetric)(A.a.CAN_START_READING_FAILURE,1),Promise.resolve(!1)}))]):[2,Promise.resolve(!1)]}var l,s}))}))},re=n(30),oe=function(e,t,n,r){return new(n||(n=Promise))((function(o,a){function i(e){try{l(r.next(e))}catch(t){a(t)}}function c(e){try{l(r.throw(e))}catch(t){a(t)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,c)}l((r=r.apply(e,t||[])).next())}))},ae=function(e,t){var n,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(a){return function(c){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(o=2&a[0]?r.return:a[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,r=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(c){a=[6,c],r=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}};!function(e){e[e.Hidden=0]="Hidden",e[e.ShowModal=1]="ShowModal",e[e.Completed=2]="Completed"}(r||(r={}));var ie,ce=window.location.origin+"/internal/bifrost/api/bifrost/acquisitions/v1/actions",le=n(10),se=Object(o.b)((function(e){var t;return{appType:e.appState.appType,renderType:e.appState.renderType,binding:null===(t=e.litbBook.litbBook)||void 0===t?void 0:t.binding,bookOffer:e.buyBox.bookOffer,interactionManager:e.appState.interactionManager,itemCount:e.buyBox.proceedToCheckoutMetadata.numberOfItemsInCart,litbBookData:e.litbBook.litbBook,litbContentMetadata:e.litbBook.contentMetadata,redirectUrl:e.buyBox.proceedToCheckoutMetadata.redirectUrl,kcmsMetadata:e.litbBook.kcmsMetadata}}),(function(e){return{setPurchaseCompleted:function(t){return e(Object(le.g)(t))}}}))((function(e){var t,n,o=Object(w.a)().getLitbTranslation,i=Object(a.useState)(r.Hidden),s=i[0],u=i[1],d=Object(a.useState)(!1),f=d[0],b=d[1],m=Object(R.a)(),p=m.weblabsReady,g=m.isWeblabEnabled,v=m.getWeblabTreatment,k=Object(I.a)().lastPositionRead;if(Object(a.useEffect)((function(){s===r.ShowModal?document.body.style.overflow="hidden":document.body.style.removeProperty("overflow")}),[s]),Object(a.useEffect)((function(){e.itemCount&&e.redirectUrl&&s===r.Hidden&&u(r.ShowModal)}),[e.itemCount,e.redirectUrl,s]),!e.bookOffer)return null;var E=Object(M.h)(e.binding),y=l.h(E,null===(t=e.bookOffer)||void 0===t?void 0:t.actionType),S=function(t){e.setPurchaseCompleted(!0);var n=v(P.b.LITB_S2F_DESKTOP_531998);(function(e,t){var n,r,o;if(t&&e&&e.fullBookAsset&&e.sampleAsset&&"NOT_LOGGED_IN"!==Object(re.a)().customerId){var a=Q.j+"/"+e.asin;return a=Object(z.a)(a,"customerId",Object(re.a)().customerId),a=Object(z.a)(a,"revision",e.revision),a=Object(z.a)(a,"sampleAssetId",null===(n=e.sampleAsset)||void 0===n?void 0:n.assetId),a=Object(z.a)(a,"fullBookAssetId",null===(r=e.fullBookAsset)||void 0===r?void 0:r.assetId),a=Object(z.a)(a,"fullBookEmbeddedId",null===(o=e.fullBookAsset)||void 0===o?void 0:o.embeddedId),a=Object(z.a)(a,"position",t.toString()),Object(Z.a)(a,{},!1).then((function(e){return e.json()})).then((function(e){return e.positionSynced?Object(_.recordCountMetric)(A.a.SYNC_LPR_SUCCESS,1):Object(_.recordCountMetric)(A.a.SYNC_LPR_FAILURE,1),e.positionSynced})).catch((function(){return Object(_.recordCountMetric)(A.a.SYNC_LPR_FAILURE,1),!1}))}return Promise.resolve(!1)})(e.kcmsMetadata,k).finally((function(){window.history.replaceState({},window.name,window.location.href+"#S2F"),function(e,t,n,r){var o;if(Object(_.recordCountAndUploadMetric)(A.a.BIFROST_SUCCESS,1),e.resources){var a="desktop"===r?"reader":"mobile",i=W(e.resources[0].states[0].links[0].url),c=window.location.origin+"/"+a+"/?asin="+t+"&ref=s2f_litb_to_kfw_"+r+"&language="+K();"desktop"===r&&n===P.a.T2?(null===(o=window.open(c,"_blank"))||void 0===o||o.focus(),parent.location.href=i):parent.location.href=c}}(t,e.asin,n,e.appType)}))},T=function(){var t,n,r;return E?null===(t=e.interactionManager)||void 0===t?void 0:t.addToCart:y?null===(r=e.interactionManager)||void 0===r?void 0:r.buyNow:null===(n=e.interactionManager)||void 0===n?void 0:n.addSample},F=function(){if(s===r.ShowModal&&(setTimeout((function(){u(r.Completed)}),2e3),document.getElementById("mainContainer")))return a.createElement("section",{className:"added-to-cart-modal"},a.createElement("div",{className:"added-to-cart-modal-text-bubble"},o("kw-litb-added-to-cart")));return null},H=h.b(),V="mobile"===e.appType||"mobile"===H||"tablet"===H,J=e.bookOffer.isOwned&&e.bookOffer.actionType===c.d.READ&&e.bookOffer.readNowUrl&&!(G.e()&&V);if(e.itemCount&&e.redirectUrl&&s===r.Completed)return a.createElement(U,{refTagPrefix:e.refTagPrefix,itemCount:e.itemCount,redirectUrl:e.redirectUrl,interactionManager:e.interactionManager});if(J)return a.createElement(B,{readNowUrl:e.bookOffer.readNowUrl,buyButtonLabel:e.bookOffer.buyButtonLabel,refTagPrefix:e.refTagPrefix});if(e.bookOffer.isOwned&&V)return a.createElement(C.a,{asin:e.asin,buttonName:o(O.a[e.usecase]),refTagPrefix:e.refTagPrefix,kindleAppUrl:e.bookOffer.kindleAppUrl,handleOnClick:null===(n=e.interactionManager)||void 0===n?void 0:n.openKindleApp,recordCountMetric:_.recordCountMetric,recordCountAndUploadMetric:_.recordCountAndUploadMetric});if(!y){if(e.bookOffer.secondaryActionType===c.d.SAMPLE&&e.bookOffer.secondaryActionId&&e.bookOffer.secondaryCsrfToken){var X=o("kw-litb-add-sample-to-library");return a.createElement(j,{acquisitionUrl:e.bookOffer.acquisitionUrl,actionId:e.bookOffer.secondaryActionId,actionType:e.bookOffer.secondaryActionType,ariaLabel:X,asin:e.asin,buttonName:X,csrfToken:e.bookOffer.secondaryCsrfToken,glideClientId:e.bookOffer.glideClientId,handleAcquisition:T(),refTagPrefix:e.refTagPrefix,sessionId:e.bookOffer.sessionId,recordCountMetric:_.recordCountMetric,isProcessing:f,setIsProcessing:b,appType:e.appType})}return null}return e.binding&&e.bookOffer.actionType&&(e.bookOffer.actionId||e.bookOffer.secondaryActionId)?a.createElement(a.Fragment,null,F(),a.createElement(j,{acquisitionUrl:ce,actionId:e.bookOffer.actionId,actionProgramCode:e.bookOffer.actionProgramCode,actionType:e.bookOffer.actionType,ariaLabel:Object(L.a)(e.bookOffer.buyButtonAriaLabel||"",{binding:e.binding,price:e.bookOffer.priceWithCoP.displayString}),asin:e.asin,buttonName:Object(L.a)(e.bookOffer.buyButtonLabel||"",{price:e.bookOffer.priceWithCoP.displayString}),buttonIcon:e.bookOffer.buyButtonIcon,csrfToken:e.bookOffer.csrfToken,glideClientId:e.bookOffer.glideClientId,handleAcquisition:T(),handleInlineAcquisition:function(t){if(!function(e){return e.resources&&e.status===c.a.SUCCESS}(t))return b(!1),function(e,t){var n,r,o,a="";if(e.resources&&e.status===c.a.VIOLATION)a=e.resources[0].states[0].links[0].url,Object(_.recordCountAndUploadMetric)(A.a.BIFROST_VIOLATION+"::"+(null===(n=e.resources[0].states[0].responseCode)||void 0===n?void 0:n.toUpperCase()),1);else if(e.errorResult)a=e.errorResult.links[0].url,Object(_.recordCountAndUploadMetric)(A.a.BIFROST_FAILURE+"::"+(null===(o=null===(r=e.errorResult)||void 0===r?void 0:r.responseCode)||void 0===o?void 0:o.toUpperCase()),1);else{var i=new URL(window.location.origin);a="https://"+q(i)+"/dp/"+t,Object(_.recordCountAndUploadMetric)(A.a.BIFROST_UNEXPECTED_RESPONSE,1)}a=W(a),parent.location.href=a}(t,e.asin);ne(e.asin).then((function(n){return oe(void 0,void 0,void 0,(function(){var r,o;return ae(this,(function(a){switch(a.label){case 0:return b(!1),!n||e.renderType===M.a.FixedFormatImage||(null===(r=e.litbContentMetadata)||void 0===r?void 0:r.comicBook)||(null===(o=e.litbContentMetadata)||void 0===o?void 0:o.childrensBook)?[2,Y(t)]:"desktop"!==e.appType?[3,2]:[4,Object(P.d)(P.b.LITB_S2F_DESKTOP_531998)];case 1:return a.sent(),[3,4];case 2:return"mobile"!==e.appType?[3,4]:[4,Object(P.d)(P.b.LITB_S2F_MOBILE_531590)];case 3:a.sent(),a.label=4;case 4:return p&&(g(P.b.LITB_S2F_MOBILE_531590)&&"mobile"===e.appType||g(P.b.LITB_S2F_DESKTOP_531998)&&"desktop"===e.appType)?[2,S(t)]:[2,Y(t)]}}))}))}))},isPhysicalItem:E,offerListingId:e.bookOffer.offerListingId,refTagPrefix:e.refTagPrefix,sessionId:e.bookOffer.sessionId,showIcon:!l.o(),inlineBiFrost:!0,recordCountMetric:_.recordCountMetric,isProcessing:f,setIsProcessing:b,appType:e.appType})):e.bookOffer.actionType&&e.binding?a.createElement(a.Fragment,null,F(),a.createElement(j,{acquisitionUrl:e.bookOffer.acquisitionUrl,actionId:e.bookOffer.actionId,actionProgramCode:e.bookOffer.actionProgramCode,actionType:e.bookOffer.actionType,ariaLabel:Object(L.a)(e.bookOffer.buyButtonAriaLabel||"",{binding:e.binding,price:e.bookOffer.priceWithCoP.displayString}),asin:e.asin,buttonName:Object(L.a)(e.bookOffer.buyButtonLabel||"",{price:e.bookOffer.priceWithCoP.displayString}),buttonIcon:e.bookOffer.buyButtonIcon,csrfToken:e.bookOffer.csrfToken,glideClientId:e.bookOffer.glideClientId,handleAcquisition:T(),isPhysicalItem:E,offerListingId:e.bookOffer.offerListingId,refTagPrefix:e.refTagPrefix,sessionId:e.bookOffer.sessionId,showIcon:!l.o(),recordCountMetric:_.recordCountMetric,isProcessing:f,setIsProcessing:b,appType:e.appType})):e.litbBookData&&e.litbBookData.title&&e.bookOffer.availability&&(e.bookOffer.availability===N.a.UNSUPPORTED_COR||e.bookOffer.availability===N.a.GEO_BLOCK)&&e.bookOffer.countryName&&e.bookOffer.countryBaseUrl&&e.bookOffer.searchUrl?a.createElement(D,{searchUrl:e.bookOffer.searchUrl,countryBaseUrl:e.bookOffer.countryBaseUrl,countryName:e.bookOffer.countryName,bookTitle:e.litbBookData.title}):e.bookOffer.usedAndNewCount&&e.bookOffer.usedAndNewLowestPrice&&e.bookOffer.usedAndNewLowestPrice.displayString?a.createElement(x,{usedAndNewCount:e.bookOffer.usedAndNewCount,usedAndNewOfferUrl:e.bookOffer.usedAndNewOfferUrl,usedAndNewLowestPrice:e.bookOffer.usedAndNewLowestPrice.displayString}):null})),ue=function(e){var t=Object(w.a)().getLitbTranslation,n=e.authorInfoList;if(n.length>1){var r=n.length-1;n=[{authorName:n[0].authorName,authorDetailPageUrl:""}];var o=Object(L.a)(t("kw-litb-authors-and-x-more")||"",{contributorOthers:""+r});n.push({authorName:o,authorDetailPageUrl:""})}var c=n.map((function(t,n){var r,o,c,l;if(""!==t.authorDetailPageUrl){var s=(o=t.authorDetailPageUrl,c=e.refTagPrefix,l=i.a(c,"aut"),i.c(o,l)),u=void 0;return(null===(r=e.interactionManager)||void 0===r?void 0:r.anchorOnClick)&&(u=e.interactionManager.anchorOnClick(s)),a.createElement("span",{className:"buy-box-contributor-container",key:n},a.createElement("a",{href:s,className:"buy-box-contributor",onClick:u,target:"_parent",rel:"noreferrer noopener"},t.authorName))}return a.createElement("span",{key:t.authorName,className:"buy-box-and-others"},t.authorName)}));return a.createElement(a.Fragment,null,c)},de=function(e){var t=e.indexOf(".")?e.split("."):[e],n="";if(!t[0][0].match(/^[0-9]/))if(t[0][0].match(/^[A-Z]/)){var r=t[0].split(/\s+/);r.length>1&&(n=r[0],t[0]=r[1])}else n=t[0][0],t[0]=t[0].slice(1);return a.createElement(a.Fragment,null,a.createElement("span",{className:"price-currency"},n),a.createElement("span",{className:"price-whole"},t[0]),function(e){if(e)return a.createElement(a.Fragment,null,a.createElement("span",{className:"price-separator"},"."),a.createElement("span",{className:"price-fraction"},e))}(t[1]))},fe=function(e,t,n){var r=e;return t&&(r+=" price-label-"+t),n&&(r+=" price-label-with-vat"),r},be=function(e){var t=Object(w.a)().getLitbTranslation,n=e.price.displayString;if(Object(a.useEffect)((function(){!n||n.length<=0?Object(_.recordCountMetric)(A.a.PRICE_LOADED,0):Object(_.recordCountMetric)(A.a.PRICE_LOADED,1)}),[]),!n||n.length<=0)return null;if(e.acquisitionType===c.d.BUY){var r=e.binding+":";return"JP"===e.marketplace&&"kindle_edition"===e.bindingSymbol&&(r=t("kw-litb-kindle-price-label")),a.createElement(a.Fragment,null,a.createElement("div",{className:fe("price-label-binding-price price-label",e.marketplace,!!e.vatMessage)},a.createElement("div",{className:"price-label-book-card-binding"},r),a.createElement("span",{className:"price-label-price"},de(n)),a.createElement("span",{className:"price-label-tax-included-string"},t("kw-litb-tax-included"))),function(){if(e.vatMessage){var t=e.vatMessage.trim();return"."!==t[t.length-1]&&(t+="."),a.createElement("span",{className:"price-label-vat-message",dangerouslySetInnerHTML:{__html:t}})}}())}return e.badgeMessage&&e.badgeUrl?a.createElement(a.Fragment,null,a.createElement("div",{className:fe("price-label-borrow",e.marketplace)},a.createElement(s.a,{badgeMessage:e.badgeMessage,badgeMessageParams:e.badgeMessageParams,badgeUrl:e.badgeUrl,badgeImageAltText:e.badgeImageAltText}),a.createElement("div",{className:"price-label-borrow-price"},a.createElement("div",{className:"price-label-price"},de(n)))),a.createElement("div",{className:"price-label-borrow-mobile"},a.createElement("span",{className:"price-label-included-with"},t("kw-litb-included-with")),a.createElement(s.a,{badgeUrl:e.badgeUrl,badgeImageAltText:e.badgeImageAltText}))):null},me=n(285),pe=function(e){var t=(0,Object(w.a)().getLitbTranslation)("kw-litb-edition")+" "+e.metaBinding;return e.date&&(t+=", "+Object(me.a)(e.date)),a.createElement("p",{className:"edition-label"},t)},Oe=function(e){var t,n=Object(w.a)().getLitbTranslation;return t=e.acquisitionType===c.b.ALC?n("kw-litb-purchased-on"):n("kw-litb-borrowed-on"),a.createElement("div",{className:"acquisition-date"},a.createElement("span",{className:"acquisition-date-label"},t+e.acquisitionDate))},he=n(405),ge=function(e){var t=Object(w.a)().getLitbTranslation;return a.createElement("section",{className:"successful-purchase-message"},a.createElement("h2",{className:"successful-purchase-message-title"},a.createElement(he.a,null)," ",t("kw-litb-thanks")),a.createElement("p",{className:"successful-purchase-message-body"},a.createElement("span",{className:"book-title"},e.bookTitle)," "+t("kw-litb-available-on-all-devices"),a.createElement("a",{href:e.thankYouUrl,onClick:e.handleOnClick,target:"_parent",rel:"noreferrer noopener"},t("kw-litb-view-order-details"))))},ve=n(294),ke=n(13),Ee=Object(o.b)((function(e){return{interactionManager:e.appState.interactionManager,showRatingsPopover:e.chromeOverlay.showRatingsPopover}}),(function(e){return{setShowRatingsPopover:function(t){return e(Object(ke.b)(ke.a.SET_SHOW_RATINGS_POPOVER,t))}}}))((function(e){var t,n,r=Object(w.a)().getLitbTranslation,o=e.asin+"-"+(e.parentClassName||""),i=e.asin+"-"+(e.parentClassName||"")+"-popover";n=1===e.numberOfReviews?r("kw-litb-ratings-singular"):r("kw-litb-ratings");var c=e.numberOfReviewsDisplayString+" "+n,l=Object(L.a)(r("kw-litb-rating-out-of-5"),{rating:e.averageRating.toString()}),s=Object(L.a)(r("kw-litb-ratings-label"),{rating:e.averageRating.toString(),reviews:e.numberOfReviewsDisplayString}),u=function(t,n,r,o){return a.createElement(a.Fragment,null,a.createElement(ve.a,{id:n,numberOfStars:5,fullStarCount:e.fullStarCount,hasHalfStar:e.hasHalfStar}),a.createElement("span",{className:r,id:o},t))};if(e.numberOfReviews){var d=(null===(t=e.interactionManager)||void 0===t?void 0:t.anchorOnClick)?e.interactionManager.anchorOnClick(e.customerReviewsUrl):void 0;return a.createElement("div",{className:"book-rating-container",onMouseEnter:function(){e.setShowRatingsPopover(!0)},onMouseLeave:function(){e.setShowRatingsPopover(!1)}},a.createElement("a",{"aria-label":s,href:e.customerReviewsUrl,className:"book-rating-link",onClick:d,target:"_parent",rel:"noreferrer noopener"},u(c,o,"book-rating-count")),a.createElement(f.b,{showPopover:e.showRatingsPopover,className:"book-rating-popover",describedBy:"book-rating-average-display-text"},a.createElement("div",{className:"book-rating-average"},u(l,i,"book-rating-average-display-text","book-rating-average-display-text"))))}return null})),we=function(e){var t,n,r,o,i=Object(w.a)().getLitbTranslation;return a.createElement("div",{className:(r=e.marketplace,o="points-label",r&&(o+=" points-label-"+r),o)},a.createElement("span",{className:"points-label-name"},i("kw-litb-points-to-be-earned"),":"),a.createElement("span",{className:"points-label-points-earnable"},e.pointsValue+" "+i("kw-litb-point")+" ("+(t=e.price,n=e.pointsValue,Math.round(n/t*100)+"%)")))},ye=n(240),Se=n(7),Re=Object(o.b)((function(e){var t;return{asin:null===(t=e.litbBook.litbBook)||void 0===t?void 0:t.asin,interactionManager:e.appState.interactionManager}}))((function(e){var t=Object(w.a)().getLitbTranslation,n=Object(a.useState)(null),r=n[0],o=n[1],i=Object(a.useState)(!1),c=i[0],l=i[1];if(Object(a.useEffect)((function(){var t;r&&(!r.authenticated&&(null===(t=e.interactionManager)||void 0===t?void 0:t.showLoginDialog)?e.interactionManager.showLoginDialog().then((function(){window.location.reload()})):r.listName&&r.listUrl&&!c&&(l(!0),setTimeout((function(){l(!1)}),2e3)))}),[r]),!e.asin)return null;var s=function(t){var n,r,a;t.preventDefault(),t.stopPropagation(),(n=Object(z.h)(),r=e.asin||"",a=n+"/wishlist/"+r+"/add-to-list",Object(Z.a)(a,{credentials:"include"},!0).then((function(e){return e.json()})).then((function(e){return e})).catch((function(e){return Object(Se.b)(e),Promise.reject(e)}))).then((function(e){return o(e)}))};return a.createElement(a.Fragment,null,a.createElement("div",{className:"add-to-list-container"},function(){var n;if(r&&r.listName&&r.listUrl){var o=(null===(n=e.interactionManager)||void 0===n?void 0:n.anchorOnClick)?e.interactionManager.anchorOnClick(r.listUrl):void 0;return a.createElement("a",{href:r.listUrl,onClick:o,target:"_parent",rel:"noreferrer noopener"},Object(L.a)(t("kw-litb-view-list"),{listName:r.listName}))}return a.createElement("a",{role:"button",onClick:s},t("kw-litb-add-to-list"))}()),c?a.createElement("section",{className:"added-to-list-modal"},a.createElement("div",{className:"added-to-list-modal-text-bubble"},t("kw-litb-added-to-list"))):null)})),Te=function(){return(Te=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},je=a.lazy((function(){return n.e(33).then(n.bind(null,433)).then((function(e){return{default:e.DeliveryLabel}}))}));!function(e){e.LEFT_TO_RIGHT="ltr",e.RIGHT_TO_LEFT="rtl"}(ie||(ie={}));var Ce=function(e){var t,n,r=e.sellerOfRecordName;return(null===(t=e.sellerDetail)||void 0===t?void 0:t.sellerPageUrl)&&(r='<a href="'+(null===(n=e.sellerDetail)||void 0===n?void 0:n.sellerPageUrl)+'" target="_parent" rel="noreferrer noopener">'+r+"</a>"),r},Ie=n(6),Me=n(33),Ne=Object(o.b)((function(e){return{appType:e.appState.appType,acquisition:e.litbBook.acquisition,bookData:e.litbBook.litbBook,bookOffer:e.buyBox.bookOffer,interactionManager:e.appState.interactionManager,productAsin:e.appState.productAsin,renderType:e.appState.renderType}}),(function(e){return{setCoverImageLoaded:function(t){return e(Object(Ie.g)(t))},setShowInlineBuyBox:function(t){return e(Object(Me.e)(t))}}}))((function(e){var t,n,r,o=Object(w.a)(),m=o.textDirection,O=o.getLitbTranslation,h=Object(a.useRef)(null),g=Object(a.useRef)(null),v=Object(a.useState)(null),k=v[0],E=v[1],y=l.h(Object(M.h)(null===(t=e.bookData)||void 0===t?void 0:t.binding),null===(n=e.bookOffer)||void 0===n?void 0:n.actionType);Object(a.useEffect)((function(){var t,n;g.current&&e.inline&&e.container&&E(new IntersectionObserver((t=e.setShowInlineBuyBox,n=g.current,function(e){if(n){var r=p()(e,(function(e){return e.target.className===n.className}));r&&r.isIntersecting?t(!0):r&&!r.isIntersecting&&t(!1)}}),{root:e.container}))}),[g.current,e.container]),Object(a.useEffect)((function(){g.current&&k&&k.observe(g.current)}),[k,g.current]),Object(a.useEffect)((function(){var t,n=g.current,r=null===(t=e.interactionManager)||void 0===t?void 0:t.anchorOnClick;n&&e.bookOffer&&r&&(n.querySelectorAll(".buy-box-buy-labels a").forEach((function(e){return Object(ye.a)(e,r)})),n.querySelectorAll(".buy-box-kindle-program-badge-cta a").forEach((function(e){return Object(ye.a)(e,r)})))}),[g.current,e.interactionManager,e.bookOffer]);var S,R,T,j=function(){e.setCoverImageLoaded(!0)},C=function(t){return e.bookOffer&&e.bookOffer.actionType===c.d.BUY&&e.bookOffer.badgeURL&&e.bookOffer.badgeMessage?a.createElement("div",{className:t},a.createElement(s.a,{badgeMessage:e.bookOffer.badgeMessage,badgeUrl:e.bookOffer.badgeURL,badgeMessageParams:e.bookOffer.badgeMessageParams,badgeImageAltText:e.bookOffer.badgeImageAltText})):null};if(e.bookData){var I=i.c(e.bookData.storeLink,i.a(e.refTagPrefix,"stl_nodl")),N=(null===(r=e.interactionManager)||void 0===r?void 0:r.anchorOnClick)?e.interactionManager.anchorOnClick(I):void 0;return a.createElement("div",{className:(R=e.inline,T="buy-box",R&&(T+=" buy-box-inline"),T)},a.createElement("div",{className:"buy-box-book-section-inner"},a.createElement("img",{alt:e.bookData.title,className:"buy-box-book-cover",src:e.bookData.coverImageUrl,style:(S=m,S===ie.LEFT_TO_RIGHT?{marginRight:"10px"}:{marginLeft:"10px"}),onLoad:j,onError:j}),function(t){var n;if(e.bookOffer&&e.acquisition.successful){var r=(null===(n=e.interactionManager)||void 0===n?void 0:n.anchorOnClick)?e.interactionManager.anchorOnClick(e.acquisition.thankYouUrl):void 0;return a.createElement(ge,{bookTitle:t.title,handleOnClick:r,thankYouUrl:e.acquisition.thankYouUrl})}return function(t){return a.createElement("div",{className:"buy-box-book-info"},a.createElement("div",{className:"buy-box-contributor-list",tabIndex:0},a.createElement(ue,{authorInfoList:t.authorInfoList,refTagPrefix:e.refTagPrefix,interactionManager:e.interactionManager})),a.createElement("div",{className:"buy-box-title-container"},a.createElement("h2",{className:"buy-box-title",ref:h,tabIndex:0},t.title)),a.createElement(Ee,{asin:t.asin,averageRating:t.averageRating,customerReviewsUrl:t.customerReviewsUrl,fullStarCount:t.fullStarCount,hasHalfStar:t.hasHalfStar,numberOfReviews:t.numberOfReviews,numberOfReviewsDisplayString:t.numberOfReviewsDisplayString,parentClassName:e.parentClassName}),C("buy-box-kindle-program-badge-inner"))}(t)}(e.bookData)),a.createElement("div",{className:"buy-box-cta-container"},a.createElement("div",{className:"buy-box-cta-container-inner"},function(){var t,n,r,o,i,c,l;if(e.bookOffer&&e.bookOffer.acquisitionDate&&e.bookOffer.acquisitionType)l=a.createElement(Oe,{acquisitionDate:e.bookOffer.acquisitionDate,acquisitionType:e.bookOffer.acquisitionType});else if(e.bookData&&e.bookOffer&&e.bookOffer.actionType&&e.bookOffer.price&&y){var s=null!=(n=null===(t=e.bookOffer)||void 0===t?void 0:t.binding)?n:null===(r=e.bookData)||void 0===r?void 0:r.binding,u=null!=(i=null===(o=e.bookOffer)||void 0===o?void 0:o.bindingSymbol)?i:null===(c=e.bookData)||void 0===c?void 0:c.bindingSymbol;l=a.createElement(be,{acquisitionType:e.bookOffer.actionType,actionProgramName:e.bookOffer.actionProgramName,badgeMessage:e.bookOffer.badgeMessage,badgeMessageParams:e.bookOffer.badgeMessageParams,badgeUrl:e.bookOffer.badgeURL,binding:s,bindingSymbol:u,marketplace:e.bookOffer.marketplace,price:e.bookOffer.priceWithCoP,vatMessage:e.bookOffer.vatMessage})}return a.createElement("div",{className:"acquisition-label"},l)}(),e.bookOffer&&e.bookOffer.pointsValue&&e.bookOffer.actionType===c.d.BUY&&y?a.createElement(we,{pointsValue:e.bookOffer.pointsValue,price:e.bookOffer.priceWithCoP.amount,marketplace:e.bookOffer.marketplace}):null,function(){var t,n,r;return"kindle_edition"!==(null===(t=e.bookOffer)||void 0===t?void 0:t.bindingSymbol)&&(null===(n=e.bookOffer)||void 0===n?void 0:n.metaBinding)?a.createElement(pe,{metaBinding:e.bookOffer.metaBinding,date:null===(r=e.bookOffer)||void 0===r?void 0:r.releaseDate}):null}(),a.createElement("div",{className:"buy-box-buy-button-container",ref:g},a.createElement(se,{asin:e.bookData.asin,usecase:"litb",refTagPrefix:e.refTagPrefix,sellerLabelPopoverDirection:e.inline?f.a.TOP:f.a.BOTTOM}),e.bookOffer&&!e.bookOffer.isOwned&&y?a.createElement(u.a,{className:"price-charged-label",defaultPrice:e.bookOffer.price,price:e.bookOffer.priceWithCoP,priceChargedMessage:O("kw-litb-price-charged")}):null,function(){if(e.bookOffer&&e.bookOffer.releaseDate&&e.bookOffer.actionType===c.d.PREORDER)return a.createElement(a.Suspense,{fallback:a.createElement("div",null)},a.createElement(je,{date:e.bookOffer.releaseDate,bindingSymbol:e.bookOffer.bindingSymbol}))}(),function(){var t,n;if(!y)return a.createElement("div",{className:"buy-box-buy-labels",tabIndex:0},a.createElement("span",{className:"purchase-not-supported-label"},O("kw-litb-kindle-purchase-not-supported")));if((null===(t=e.bookOffer)||void 0===t?void 0:t.actionType)===c.d.BUY){var r={};return(null===(n=e.bookOffer)||void 0===n?void 0:n.legalMessage)||(r.textAlign="center"),a.createElement("div",{className:"buy-box-buy-labels",tabIndex:0,style:r},function(){var t;return(null===(t=e.bookOffer)||void 0===t?void 0:t.legalMessage)?a.createElement(d.a,{className:"legal-label",content:e.bookOffer.legalMessage}):null}(),function(){if(e.bookOffer){var t=void 0;if("kindle_edition"===e.bookOffer.bindingSymbol)t=O("kw-litb-sold-by");else if(e.bookOffer.isFulfilledByAmazon&&e.bookOffer.fulfillerName){var n=Ce(e.bookOffer),r=Object(L.a)(O("kw-litb-fulfilled-by"),{fulfillerName:e.bookOffer.fulfillerName});e.bookOffer.fulfillerPageUrl&&(r='<a href="'+e.bookOffer.fulfillerPageUrl+'" target="_parent" rel="noreferrer noopener">'+r+"</a>"),t=Object(L.a)(O("kw-litb-sold-by-fulfilled-by"),{sellerName:n,fulfillerName:r})}else t=Object(L.a)(O("kw-litb-ships-from-sold-by"),{sellerName:Ce(e.bookOffer)});return a.createElement(b.a,{bindingSymbol:e.bookOffer.bindingSymbol,className:"seller-label",fulfillerName:e.bookOffer.fulfillerName,fulfillerPageUrl:e.bookOffer.fulfillerPageUrl,isFulfilledByAmazon:e.bookOffer.isFulfilledByAmazon,localizedSellerDetailLabels:{address:O("kw-litb-address"),closeButtonLabel:O("kw-litb-back"),email:O("kw-litb-email"),helpUrl:O("kw-litb-help-url"),name:O("kw-litb-name"),representative:O("kw-litb-representative"),telephone:O("kw-litb-telephone")},popoverDirection:e.inline?f.a.TOP:f.a.BOTTOM,priceMessage:O("kw-litb-price-set-by-seller"),pricingBusinessModel:Te(Te({},e.bookOffer.pricingBusinessModel),{sellerOfRecordName:e.bookOffer.sellerOfRecordName}),refTagPrefix:e.refTagPrefix,sellerDetail:e.bookOffer.sellerDetail,soldByMessage:t})}return null}())}return null}(),a.createElement("div",{className:"buy-box-or"},O("kw-litb-endactions-or")),a.createElement("a",{href:I,onClick:N,target:"_parent",rel:"noreferrer noopener",className:"buy-box-back-prompt"},O("kw-litb-back-to-store")),C("buy-box-kindle-program-badge-cta"),l.o()?a.createElement(Re,null):null)),function(){var t;if(e.bookData&&(e.productAsin||e.renderType===M.a.FixedFormatImage)&&!l.o()){var n=i.c(e.bookData.storeLink,i.a(e.refTagPrefix,"std_nodl")),r=(null===(t=e.interactionManager)||void 0===t?void 0:t.anchorOnClick)?e.interactionManager.anchorOnClick(n):void 0;return a.createElement("div",{className:"buy-box-view-in-store-options"},a.createElement("a",{href:n,onClick:r,target:"_parent",rel:"noreferrer noopener"},O("kw-litb-view-in-store-options")))}return null}()))}return null}))},269:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0),o=n(54),a=n(35),i=function(e){Object(r.useEffect)((function(){var t,n=function(){t=e(),o.a.deregisterEventListener(a.b.Book.FIRST_PAGE_RENDERED,n)};return o.a.registerEventListener(a.b.Book.FIRST_PAGE_RENDERED,n),function(){o.a.deregisterEventListener(a.b.Book.FIRST_PAGE_RENDERED,n),t&&t()}}),[])}},285:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(40);var o=function(e){return new Date(e).toLocaleDateString(r.a(),{year:"numeric",month:"long",day:"numeric",timeZone:"UTC"})}},286:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(0),o=n(210),a=n(118),i=n(39),c=function(e){var t=Object(r.useState)(!0),n=t[0],c=t[1],l=e.className?"notice-"+e.className:"";return r.createElement(o.a,{timeout:i.f,in:n,classNames:"notice-container"},r.createElement("div",{role:"banner",className:"notice-container "+l},function(){if(e.icon){var t="notice-icon"+(e.content.length?"":" center-vert");return r.createElement("div",{className:t},e.icon)}}(),r.createElement("div",{className:"notice-body"},r.createElement("p",{className:"notice-title"},e.title),function(){if(e.content.length)return r.createElement("div",{className:"notice-content",dangerouslySetInnerHTML:{__html:e.content}})}()),r.createElement("button",{className:"close-notice",onClick:function(){c(!1)}},r.createElement(a.a,{color:"#005a66",id:"banner-notice"}))))}},287:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(0),o=n(15),a=n(407),i=n(408),c=n(409),l=n(56),s=n(286),u=function(e){var t=Object(l.a)().getLitbTranslation,n=Object(r.useState)(o.e()),u=n[0],d=n[1];Object(r.useEffect)((function(){var e=function(){d(o.e())};return window.addEventListener("resize",e),function(){window.removeEventListener("resize",e)}}),[]);var f=t("kw-litb-notification-fixed-format-instructions"),b=r.createElement(c.a,null),m=t("kw-litb-notification-fixed-format-title");return(o.l()||o.i())&&(f=t("kw-litb-notification-fixed-format-instructions-mobile"),b=r.createElement(a.a,null),m=t("kw-litb-notification-fixed-format-title-mobile"),e.childrensBook&&"Portrait"===u&&(f="",m=t("kw-litb-notification-fixed-format-cb-rotate"),b=r.createElement(i.a,null))),r.createElement(s.a,{className:"fixed-format",content:f,icon:b,title:m})}},288:function(e,t,n){"use strict";n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return c}));var r=n(39),o=n(5),a=function(e,t){var n,o,a=!!(null===(n=t)||void 0===n?void 0:n.comicBook),i=!!(null===(o=t)||void 0===o?void 0:o.childrensBook);return!(!(e&r.s)||a||i)},i=function(e){return!!(e&r.q||Object(o.j)())},c=function(e){return!!(e&r.a)}},289:function(e,t,n){"use strict";n.d(t,"a",(function(){return T}));var r=n(0),o=n(4),a=n(406),i=n(212),c=n(247),l=n(56),s=n(76),u=r.forwardRef((function(e,t){var n=Object(r.useRef)(null),o=Object(r.useRef)(null),u=Object(r.useRef)(null),d=Object(r.useRef)(null),f=Object(r.useRef)(null),b=Object(l.a)().getLitbTranslation,m=Object(s.a)();Object(r.useImperativeHandle)(t,(function(){return{contains:function(e){return!!o.current&&o.current.contains(e)},focus:function(){f.current&&(f.current.hidden=!0),n.current&&n.current.focus()},getMenuItems:function(){if(o.current)return document.querySelectorAll(".search-bar-menuitem")}}}));var p,O=function(){e.handleSearch(),m.emitInBookAction({action:"SearchClick",context:"Search",value:""}),n.current&&n.current.focus()},h=function(t){t.preventDefault(),t.stopPropagation(),e.clearSearch(),n.current&&n.current.focus()},g=function(e){e.preventDefault(),e.stopPropagation(),O()},v=function(e){if(i.e(e)){var t=document.querySelectorAll(".search-result-item-link");t&&t.length&&(e.preventDefault(),e.stopPropagation(),t[0].focus())}};return e.show?r.createElement(r.Fragment,null,r.createElement("div",{className:(p="search-bar",e.className&&(p+=" "+e.className),p),ref:o},r.createElement("div",{className:"search-bar-form",role:"search"},r.createElement(c.a,{className:"search-icon"}),r.createElement("input",{"aria-label":b("kw-litb-search-input-field-editing"),className:"search-bar-menuitem search-bar-input",onChange:e.handleUpdateSearchQuery,onClick:function(e){e.preventDefault(),e.stopPropagation(),n.current&&n.current.focus()},onKeyDown:function(e){i.c(e)?(e.preventDefault(),e.stopPropagation(),O()):i.e(e)&&(d.current?(e.preventDefault(),e.stopPropagation(),d.current.focus()):u.current&&(e.preventDefault(),e.stopPropagation(),u.current.focus()))},onKeyUp:function(e){e.preventDefault(),e.stopPropagation()},ref:n,type:"search",placeholder:b("kw-litb-search-input-field-placeholder"),value:e.searchQuery}),function(){if(!e.showSearchResults&&e.searchQuery.length)return r.createElement("button",{"aria-label":b("kw-litb-search-submit-button-label"),className:"search-bar-submit-button",onClick:g,ref:d},b("kw-litb-search"))}(),function(){if(e.showSearchResults)return r.createElement("button",{"aria-label":b("kw-litb-search-clear-text-button"),className:"search-bar-menuitem search-clear-button",onClick:h,onKeyDown:v,ref:u},r.createElement(a.a,null))}()),r.createElement("div",{className:"search-bar-vertical-bar"}),r.createElement("button",{className:"search-bar-cancel-button",onClick:function(){e.setShowSearchModal(!1)}},b("kw-litb-cancel"))),r.createElement("div",{ref:f,className:"search-bar-overlay"})):null})),d=n(34),f=n(13),b=Object(o.b)((function(e){return{searchQuery:e.search.searchQuery,showSearchResults:e.search.showSearchResults}}),(function(e){return{clearSearch:function(){return e(Object(d.b)())},setSearchResultItems:function(t){return e(Object(d.e)(t))},setShowSearchResults:function(t){return e(Object(d.g)(t))},setShowSearchModal:function(t){return e(Object(f.b)(f.a.SET_SHOW_SEARCH_MODAL,t))}}}),null,{forwardRef:!0})(u),m=function(e,t,n,r){var o=n[1],a=0,i=e.length;return o-a>r&&(a=function(e,t,n){for(var r=0;r<e.length-1;r++)if(" "===e[r]&&" "!==e[r+1]&&t-r<=n)return r+1;return-1}(e,o,r)),i-o>r&&(i=function(e,t,n){for(var r=e.length-2;r>0;r--)if(" "!==e[r]&&" "===e[r+1]&&r-t<=n)return r+1;return-1}(e,o,r)),[a,o,i]},p=r.forwardRef((function(e,t){return r.createElement(b,{className:e.className,show:e.show,handleSearch:function(){var t=e.searchQuery,n=[];t&&(n=function(e,t){var n=[];return t.forEach((function(t){var r=t.content,o=function(e,t){for(var n=[],r=e.indexOf(t),o=1;r>-1;)n.push([o,r]),r=e.indexOf(t,r+1),o++;return n}(r.toLowerCase(),e.toLowerCase());o.length>0&&o.forEach((function(o){var a=m(r,e,o,70),i={appearancesInPid:o[0],context:{text:r,endPos:a[2],keywordStartPos:a[1],startPos:a[0]},keyword:e,pidIndex:t.pidIndex};n.push(i)}))})),n}(t,e.bookContent)),e.setShowSearchResults(n.length>0||t.length>0),e.setSearchResultItems(n);var r=document.querySelector(".search-results-section");r&&(r.scrollTop=0)},handleUpdateSearchQuery:function(t){e.setSearchQuery(t.target.value.toString())},ref:t})})),O=Object(o.b)((function(e){return{searchQuery:e.search.searchQuery,bookContent:e.litbBook.bookContent}}),(function(e){return{setSearchQuery:function(t){return e(Object(d.d)(t))},setSearchResultItems:function(t){return e(Object(d.e)(t))},setShowSearchResults:function(t){return e(Object(d.g)(t))}}}),null,{forwardRef:!0})(p),h=n(248),g=n.n(h),v=n(2),k=n(79),E=n(3),w=n(17),y=n(78),S=r.forwardRef((function(e,t){var n=Object(r.useState)(new AbortController),o=n[0],a=n[1],i=function(e){var t=Object(r.useRef)();return Object(r.useEffect)((function(){t.current=e})),t.current}(e.searchQuery),c=Object(y.a)(),l=c.weblabsReady;c.isWeblabEnabled;Object(r.useEffect)((function(){i&&!e.searchQuery&&(o.abort(),e.setShowSearchResults(!1))}),[o,e.searchQuery,i]),Object(r.useEffect)((function(){if(l){var t=e.isOverlayModeOn?1:0;Object(E.recordCountMetric)(w.a.LITB_PRINT_SEARCH_SHOWN,t,!0),Object(E.recordSessionsWithCountMetric)(w.a.LITB_PRINT_SEARCH_SHOWN,t)}}),[e.isOverlayModeOn,l]);var s=function(t){var n=t||e.searchQuery,r=!n.trim();if(e.asin&&n.trim()){o.abort();var i=new AbortController;a(i);var c=Object(E.createLatencyMetric)(w.a.LITB_PRINT_SEARCH_LATENCY);Object(v.d)(e.asin,e.asin,n,e.pageNumber,e.pageSize,i.signal).then((function(t){Object(k.b)(t)?(e.setSearchResults(t),e.setShowSearchResults(!0),Object(E.recordCountMetric)(w.a.LITB_LOADED_PRINT_SEARCH_RESULTS,1),Object(E.recordLatencyMetric)(c)):Object(k.a)(t)?(e.setSearchResults({highlights:{},jumboImageUrls:{},largeImageUrls:{},results:[],totalResults:t.totalResults}),e.setShowSearchResults(!0),Object(E.recordLatencyMetric)(c),Object(E.recordCountMetric)(w.a.LITB_LOADED_PRINT_SEARCH_RESULTS,1)):Object(E.recordCountMetric)(w.a.LITB_LOADED_PRINT_SEARCH_RESULTS,0)})).catch((function(e){e&&e.error&&"AbortError"===e.error.name?Object(E.recordCountMetric)(w.a.LITB_PRINT_SEARCH_ABORTED,1):(Object(E.recordLatencyMetric)(c),Object(E.recordCountMetric)(w.a.LITB_LOADED_PRINT_SEARCH_RESULTS,0))}));var l=document.querySelector(".search-results-section");l&&(l.scrollTop=0)}else r&&n.length>0&&e.setShowSearchResults(!0)},u=Object(r.useCallback)(g()(s,500,{trailing:!0}),[]);return r.createElement(b,{className:e.className,show:e.show,handleSearch:s,handleUpdateSearchQuery:function(t){var n=t.target.value;e.setSearchQuery(n),Object(E.recordCountMetric)(w.a.LITB_PRINT_SEARCH_QUERY_ENTERED,1),u(n)},ref:t})})),R=Object(o.b)((function(e){return{asin:e.appState.asin,isOverlayModeOn:e.chromeOverlay.isOverlayModeOn,pageNumber:e.search.pageNumber,pageSize:e.search.pageSize,searchQuery:e.search.searchQuery}}),(function(e){return{setSearchQuery:function(t){return e(Object(d.d)(t))},setSearchResults:function(t){return e(Object(d.f)(t))},setShowSearchResults:function(t){return e(Object(d.g)(t))}}}),null,{forwardRef:!0})(S),T=function(e){return e.renderType===v.a.YJHTML?r.createElement(O,{ref:e.searchBarRef,show:e.show,className:e.className}):e.renderType===v.a.FixedFormatImage?r.createElement(R,{ref:e.searchBarRef,show:e.show,className:e.className}):null}},290:function(e,t,n){"use strict";n.d(t,"a",(function(){return K}));var r,o=n(4),a=n(13),i=n(0),c=n(210),l=n(21),s=n(230),u=n(217),d=n(15),f=n(212),b=n(39),m=function(){return(m=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},p=!!window.localStorage,O=n(56),h=n(77),g=n(386),v=n(73),k=n(211),E=i.forwardRef((function(e,t){var n=Object(O.a)().getLitbTranslation,r=Object(i.useRef)(null),o=Object(i.useRef)(null);Object(i.useImperativeHandle)(t,(function(){return{contains:function(e){return!!r.current&&r.current.contains(e)},focus:function(){o.current&&o.current.focus()},getMenuItems:function(){if(r.current)return r.current.querySelectorAll(".font-option")}}}));var a=e.contentMetadata?e.contentMetadata.language:null,c=v.e(a),l=v.d(a,e.initialFontId);return i.createElement("div",{className:"display-option font-options-container",ref:r},v.c[c].map((function(t,r){var a,c=l===t,s="font-"+t+(c?"-selected":"-noselected"),u=c?Object(k.a)(n("kw-litb-option-enabled")||"",{option:t}):t;return i.createElement("button",{ref:0===r?o:null,key:t,id:t,onClick:(a=t,function(){a!==l&&e.updateFontCallback(a)}),onKeyUp:function(n){return function(t,n){f.c(t)&&e.updateFontCallback(n)}(n,t)},className:"font-option "+s,"aria-label":u,"data-index":r,tabIndex:-1},i.createElement(g.a,{fontChoice:s}))})))})),w=n(387),y=n(388),S=n(293),R=n(48),T=i.forwardRef((function(e,t){var n=Object(O.a)().getLitbTranslation,r=Object(i.useRef)(null),o=Object(i.useRef)(null);Object(i.useImperativeHandle)(t,(function(){return{contains:function(e){return!!r.current&&r.current.contains(e)},focus:function(){o.current&&o.current.focus()},getMenuItems:function(){if(r.current)return r.current.querySelectorAll(".font-size-selector-menu-item")}}}));return i.createElement("div",{className:"display-option font-size-options-container",ref:r},i.createElement("button",{className:"font-size-button font-smaller",onClick:function(){e.updateFontSize(Math.max(0,e.fontSize-1))},"data-index":0,"aria-label":n("kw-litb-font-size-button-smaller"),disabled:0===e.fontSize,tabIndex:-1},i.createElement(y.a,null)),i.createElement("div",{id:"FontSizeOptions",className:"font-size-selector-menu-item font-size-options",tabIndex:-1,"data-index":1},i.createElement(S.a,{axleCount:R.b.length,axleAriaLabel:n("kw-litb-label-font-size")||"",axleClassName:"font-size-option",color:b.b,handleUpdatePosition:e.updateFontSize,position:e.fontSize,ref:o,selectedColor:b.i,containerId:"FontSizeOptions",sliderKnobClassName:"font-size-slider-knob"})),i.createElement("button",{"aria-label":n("kw-litb-font-size-button-larger"),className:"font-size-button font-larger","data-index":2,onClick:function(){e.updateFontSize(Math.min(R.b.length-1,e.fontSize+1))},disabled:e.fontSize===R.b.length-1,tabIndex:-1},i.createElement(w.a,null)))})),j=n(17),C=n(3),I=n(389),M=n(390),N=i.forwardRef((function(e,t){var n=Object(O.a)().getLitbTranslation,r=Object(i.useRef)(null),o=Object(i.useRef)(null);Object(i.useImperativeHandle)(t,(function(){return{contains:function(e){return!!r.current&&r.current.contains(e)},focus:function(){o.current&&o.current.focus()},getMenuItems:function(){if(r.current)return r.current.querySelectorAll(".zoom-selector-menu-item")}}}));return i.createElement("div",{className:"zoom-selector-container"},i.createElement("h3",{className:"zoom-selector-header"},n("kw-litb-zoom-header")),i.createElement("div",{className:"display-option zoom-options-container",ref:r},i.createElement("button",{className:"zoom-button zoom-out",onClick:function(){Object(C.recordCountMetric)(j.a.ZOOM_OUT_BUTTON_PRESSED,1),e.updateZoomPercent(Math.max(100,e.zoomPercent-10))},"data-index":0,"aria-label":n("kw-litb-zoom-out-button"),disabled:100===e.zoomPercent},i.createElement(I.a,{className:"zoom-icon"})),i.createElement("div",{id:"ZoomSelector",className:"zoom-selector-menu-item zoom-options",tabIndex:-1,"data-index":1},i.createElement(S.a,{axleAriaLabel:n("kw-litb-label-zoom")||"",axleClassName:"zoom-option",color:b.b,continuous:!0,handleUpdatePosition:function(t){Object(C.recordCountMetric)(j.a.ZOOM_SLIDER_SCRUBBED,1),e.updateZoomPercent(function(e){return 100*(e+1)}(t))},position:e.zoomPercent/100-1,selectedColor:b.i,containerId:"ZoomSelector",ref:o,sliderKnobClassName:"zoom-slider-knob"})),i.createElement("button",{"aria-label":n("kw-litb-zoom-in-button"),className:"zoom-button zoom-in","data-index":2,onClick:function(){Object(C.recordCountMetric)(j.a.ZOOM_IN_BUTTON_PRESSED,1),e.updateZoomPercent(Math.min(200,e.zoomPercent+10))},disabled:200===e.zoomPercent},i.createElement(M.a,{className:"zoom-icon"}))))})),L=n(225),P=n(1),_=n(391),A=n(392),x=n(393),D=n(394),z=Object(o.b)((function(e){var t;return{appType:e.appState.appType,aboutKindleUrl:null===(t=e.litbBook.litbBook)||void 0===t?void 0:t.aboutKindleUrl,interactionManager:e.appState.interactionManager}}),null,null,{forwardRef:!0})((function(e){var t,n,r=Object(O.a)().getLitbTranslation;return(null===(t=e.interactionManager)||void 0===t?void 0:t.anchorOnClick)&&e.aboutKindleUrl&&(n=e.interactionManager.anchorOnClick(e.aboutKindleUrl)),i.createElement("article",{className:"upsell-widget",onContextMenu:function(e){return e.preventDefault()}},i.createElement("img",{src:D.a()+"/devices.png",alt:"Devices",className:"upsell-widget-devices-image"}),i.createElement("h4",{className:"upsell-widget-header"},r("kw-litb-upsell-widget-header")),i.createElement("p",{className:"upsell-widget-description"},"mobile"===e.appType?r("kw-litb-upsell-widget-description-mobile"):r("kw-litb-upsell-widget-description")),i.createElement("ul",{className:"upsell-widget-points"},i.createElement("li",{className:"upsell-widget-point"},i.createElement(_.a,null),i.createElement("span",{className:"upsell-widget-bullet-points"},r("kw-litb-upsell-widget-first-bullet"))),i.createElement("li",{className:"upsell-widget-point"},i.createElement(x.a,null),i.createElement("span",{className:"upsell-widget-bullet-points"},r("kw-litb-upsell-widget-second-bullet"))),i.createElement("li",{className:"upsell-widget-point"},i.createElement(A.a,null),i.createElement("span",{className:"upsell-widget-bullet-points"},r("kw-litb-upsell-widget-third-bullet")))),i.createElement("a",{href:e.aboutKindleUrl,className:"upsell-widget-learn-more",onClick:n,target:"_parent",rel:"noreferrer noopener"},r("kw-litb-upsell-widget-learn-more"),i.createElement("span",{className:"upsell-widget-learn-more-period"},".")))})),B=n(76);!function(e){e.ChangeFontFamily="ChangeFontFamily",e.ChangeFontSize="ChangeFontSize",e.ChangeZoomPercent="ChangeZoomPercent",e.ChangeFontColor="ChangeFontColor",e.ChangeFontAlignment="ChangeFontAlignment"}(r||(r={}));var U=["ta","hi","mr","mr","ml","gu"],F=function(e){return{fontId:e.fontId,fontSizeIndex:e.fontSizeIndex,fontSize:R.b[e.fontSizeIndex],fontColor:e.fontColor,fontAlignment:e.fontAlignment,zoomPercent:e.zoomPercent}},H=function(e){var t="display-options-container";return d.m()&&(t+=" display-options-ios-safari-container"),e&&(t+=" display-options-with-upsell"),t},q=i.forwardRef((function(e,t){var n=function(e,t){var n=Object(i.useState)((function(){var n=p&&window.localStorage.getItem(e);return n?JSON.parse(n):t})),r=n[0],o=n[1];return{offlineData:r,setOfflineData:function(t){if(p){var n=window.localStorage.getItem(e);if(null!==n){var r={};try{r=JSON.parse(n)}finally{t=m(m({},r),t)}}}o(t),p&&window.localStorage.setItem(e,JSON.stringify(t))}}}(b.h,F(e)).setOfflineData,o=Object(O.a)().getLitbTranslation,a=Object(i.useRef)(null),g=Object(i.useRef)(null),v=Object(i.useRef)(null),k=Object(i.useRef)(null),w=Object(B.a)(),y=Object(i.useState)(!1),S=y[0],R=y[1];Object(i.useEffect)((function(){e.renderType&&Object(C.recordCountMetric)(Object(C.getSuccessMetricName)(Object(P.d)(P.a.DISPLAY_OPTIONS_SHOWN,e.renderType)),1)}),[e.isOverlayModeOn,e.showDisplayOptions,e.renderType]),Object(i.useImperativeHandle)(t,(function(){return{focusFirstActiveElement:function(){v.current?v.current.focus():g.current?g.current.focus():k.current&&k.current.focus()},focusLastActiveElement:function(){g.current&&g.current.focus()}}}));var I=e.fontId,M=e.fontSizeIndex,_=(e.fontColor,e.fontAlignment,Object(i.useRef)(!0));Object(i.useEffect)((function(){_.current?_.current=!1:n(F(e))}),[e.fontId,e.fontSizeIndex,e.fontAlignment,e.fontColor]),Object(i.useEffect)((function(){var t=function(t){var n=f.a(t);n!==u.g&&n!==u.h||(e.setShowDisplayOptions(!1),e.setOverlayMode(!0))};return e.showDisplayOptions&&e.focusFirstElementOnOpen&&(setTimeout((function(){v.current&&v.current.focus()}),300),document.addEventListener("keyup",t)),e.showDisplayOptions&&a.current?a.current.removeAttribute("aria-hidden"):a.current&&a.current.setAttribute("aria-hidden","true"),function(){document.removeEventListener("keyup",t)}}),[e.showDisplayOptions]);var A=function(t){e.setFontId(t),Object(h.h)(!0),w.emitInBookAction({action:r.ChangeFontFamily,context:"AAMenu",value:t})},x=function(t){e.setFontSizeIndex(t),Object(h.h)(!0),e.setShowInlineEndActions(!1),Object(L.e)(),w.emitInBookAction({action:r.ChangeFontSize,context:"AAMenu",value:""+t})},D=function(t){w.emitInBookAction({action:r.ChangeZoomPercent,context:"AAMenu",value:""+t}),e.setZoomPercent(t)},q=function(){return!(!e.contentMetadata||!e.contentMetadata.language)&&!U.includes(e.contentMetadata.language)};return i.createElement(c.a,{in:e.showDisplayOptions,timeout:300,classNames:d.m()&&"Landscape"===d.e()?"display-options-ios-safari-slide-down":"display-options-slide-down"},i.createElement("section",{ref:a,role:"complementary",className:H(S),"aria-label":o("kw-litb-aa-menu")||"",onKeyDown:function(e){if(g.current&&v.current)if(f.e(e)&&e.shiftKey&&g.current.contains(e.target))e.preventDefault(),e.stopPropagation(),v.current.focus();else if(f.e(e)&&!e.shiftKey&&v.current.contains(e.target))e.preventDefault(),e.stopPropagation(),g.current.focus();else{var t=void 0;if(v.current.contains(e.target)?t=v.current.getMenuItems():g.current.contains(e.target)&&(t=g.current.getMenuItems()),t){var n=document.activeElement;if(n&&n.dataset.index){var r=parseInt(n.dataset.index,10);s.a(e,t,r)}}}}},function(){if(e.rendererCapabilities&&e.rendererCapabilities&l.a.Reflowable){var t=void 0;return q()&&(t=i.createElement(i.Fragment,null,i.createElement(E,{contentMetadata:e.contentMetadata,initialFontId:I,updateFontCallback:A,ref:v}),i.createElement("div",{className:"display-option-rule-container"},i.createElement("div",{className:"display-option-rule"})))),i.createElement(i.Fragment,null,t,i.createElement(T,{fontSize:M,updateFontSize:x,ref:g}))}return null}(),e.rendererCapabilities&&e.rendererCapabilities&l.a.PinchToZoom?(Object(C.recordCountMetric)(j.a.ZOOM_SELECTOR_SHOWN,1),i.createElement(N,{zoomPercent:e.zoomPercent,updateZoomPercent:D,ref:k})):null,function(){if(e.showUpsellWidget)return S||"mobile"!==e.appType||R(!0),i.createElement(z,null);S&&R(!1)}()))})),W=n(57),K=Object(o.b)((function(e,t){return{appType:e.appState.appType,isOverlayModeOn:e.chromeOverlay.isOverlayModeOn,showDisplayOptions:e.chromeOverlay.showDisplayOptions||t.showDisplayOptions,contentMetadata:e.litbBook.contentMetadata,fontId:e.renderer.displayOptions.fontId,fontSizeIndex:e.renderer.displayOptions.fontSizeIndex,fontColor:e.renderer.displayOptions.fontColor,fontAlignment:e.renderer.displayOptions.fontAlignment,rendererCapabilities:e.renderer.capabilities,renderType:e.appState.renderType,showUpsellWidget:!!e.renderer.displayOptions.showUpsellWidget,zoomPercent:e.renderer.displayOptions.zoomPercent}}),(function(e){return{setShowDisplayOptions:function(t){return e(Object(a.b)(a.a.SET_DISPLAY_OPTIONS,t))},setOverlayMode:function(t){return e(Object(a.b)(a.a.SET_OVERLAY_MODE,t))},setFontId:function(t){return e(Object(W.e)(t))},setFontColor:function(t){return e(Object(W.d)(t))},setFontAlignment:function(t){return e(Object(W.c)(t))},setFontSizeIndex:function(t){return e(Object(W.f)(t))},setShowInlineEndActions:function(t){return e(Object(a.b)(a.a.SET_SHOW_INLINE_END_ACTIONS,t))},setZoomPercent:function(t){return e(Object(W.i)(t))}}}),null,{forwardRef:!0})(q)},291:function(e,t,n){"use strict";n.d(t,"a",(function(){return R}));var r=n(0),o=n(212),a=n(230),i=n(4),c=n(56),l=n(395),s=n(211),u=n(39),d=r.forwardRef((function(e,t){var n,i,d=Object(r.useRef)(null),f=Object(r.useRef)(null),b=Object(r.useRef)(null),m=Object(r.useRef)(null),p=Object(c.a)().getLitbTranslation,O=(n=e.searchResultItems)?n.length:0,h=Object(r.useRef)(null);i=1===e.searchResultItems.length?p("kw-litb-results-singular"):p("kw-litb-results");var g=p("kw-litb-search-results-mentions-in-this-sample")+", "+e.searchResultItems.length+" "+i,v=Object(s.a)(p("kw-litb-search-results-alternative-message"),{keyword:e.searchQuery}),k="";e.searchResultItems.length?k=g:e.searchQuery.length&&(k=v);Object(r.useImperativeHandle)(t,(function(){return{contains:function(e){return!!h.current&&h.current.contains(e)},focus:function(){if(h.current)return h.current.focus()},getMenuItems:function(){if(h.current)return h.current.querySelectorAll(".search-result-item-link")}}}));Object(r.useEffect)((function(){e.showSearchResult&&function(){var t;if(e.searchResultItems.length&&"desktop"===e.appType){if(t=document.querySelector(".search-results")){var n=document.querySelector(".search-results-section");t.style.height="calc(100% - 50px)",n.scrollHeight===n.clientHeight&&(t.style.height="auto")}}else(t=document.querySelector(".search-results"))&&(t.style.height="auto")}()}),[e.showSearchResult,e.searchQuery,e.searchResultItems.length]);return e.showSearchResult?r.createElement("div",{"aria-label":k,className:"search-results",onKeyDown:function(t){o.b(t)&&(t.stopPropagation(),e.searchResultItems.length&&document.querySelectorAll("."+u.j+" .search-result-item-link")[0].focus())},ref:h,role:"presentation",tabIndex:0},function(){if(e.searchResultItems.length)return r.createElement("div",{className:"mention-text-container"},r.createElement(l.a,null),r.createElement("h3",{className:"mention-text",ref:m,tabIndex:-1},p("kw-litb-in-this-book")),r.createElement("div",{className:"mention-count"},"("+e.searchResultItems.length+")"))}(),r.createElement("section",{className:"search-results-section",onKeyDown:function(e){var t=document.querySelectorAll("."+u.j+" .search-result-item-link"),n=document.activeElement,r=parseInt(n.dataset.index,10);a.a(e,t,r)},role:"presentation"},function(){if(e.searchResultItems.length>0){var t=e.searchResultItems.map((function(t,n){return r.createElement("li",{className:"search-result-item",key:n},e.renderSearchResultItem(t,n,function(e){return-1===O?void 0:0===e?d:e===O?f:void 0}(n)))}));return r.createElement("ul",{id:"seach-results",className:"search-results-inner",role:"menu"},t)}return e.searchQuery.length>0?r.createElement("div",{className:"search-result-alternative-message",tabIndex:-1,ref:b},v):null}())):null})),f=n(79),b=Object(i.b)((function(e){var t;return t=Object(f.b)(e.search.searchResults)&&e.search.searchResults.results?e.search.searchResults.results:e.search.searchResultItems,{appType:e.appState.appType,searchResultItems:t,showSearchResult:e.search.showSearchResults,searchQuery:e.search.searchQuery}}),null,null,{forwardRef:!0})(d),m=r.forwardRef((function(e,t){var n=Object(c.a)().getLitbTranslation,o=function(e){return e.context.text.substring(e.context.startPos,e.context.endPos)+", "+n("kw-litb-search-result-item-guide")},a=function(t){return function(){(function(t){return e.setSearchHighlightsKindle(t),Promise.resolve()})(t).then((function(){e.setOverlayMode(!1),e.setShowSearchModal(!1),e.goToPosition(t.pidIndex,{focus:!0})}))}};return r.createElement(b,{renderSearchResultItem:function(e,t,n){if("keyword"in e)return r.createElement("button",{"aria-label":o(e),className:"search-result-item-link","data-index":t,onClick:a(e),ref:n,role:"menuitem",tabIndex:-1},r.createElement("div",null,"..."+e.context.text.substring(e.context.startPos,e.context.keywordStartPos),r.createElement("span",{className:"search-result-keyword"},e.context.text.substring(e.context.keywordStartPos,e.context.keywordStartPos+e.keyword.length)),e.context.text.substring(e.context.keywordStartPos+e.keyword.length,e.context.endPos)+"..."));throw new Error("Wrong search component used.")},ref:t})})),p=n(13),O=n(34),h=Object(i.b)(null,(function(e){return{setOverlayMode:function(t){return e(Object(p.b)(p.a.SET_OVERLAY_MODE,t))},setSearchHighlightsKindle:function(t){return e(Object(O.c)(t))},setShowSearchModal:function(t){return e(Object(p.b)(p.a.SET_SHOW_SEARCH_MODAL,t))}}}),null,{forwardRef:!0})(m),g=n(280),v=n.n(g),k=n(231),E=function(e){return e?"search-result-item-context":"search-result-item-not-included"},w=r.forwardRef((function(e,t){var n=Object(c.a)().getLitbTranslation,o=Object(r.useState)([]),a=o[0],i=o[1];Object(r.useEffect)((function(){if(e.numberOfPages){var t=[];if(e.bookmarks&&e.bookmarks.forEach((function(e){var n=e[0],r=e[1],o=e[2];v()(r,r+o).forEach((function(e){t[e]=n}))})),e.pageLabelSet)e.pageLabelSet.split("),").forEach((function(r){var o=r.replace("(","").replace(")","").split(","),a=o[0],i=o[1],c=o[2],s=new RegExp("/"+n("kw-litb-front-cover")+"|"+n("kw-litb-back-cover")+"|"+n("kw-litb-front-flap")+"|"+n("kw-litb-back-flap")+"/"),u=parseInt(a,10);v()(u,e.numberOfPages).forEach((function(e){if(!t[e]||!t[e].match(s))if("a"===i){var n=e-u+parseInt(c,10);t[e]=l(n.toString())}else if("r"===i){n=k.a(e-u+parseInt(c,10));t[e]=l(n)}}))}));i(t)}}),[e.bookmarks,e.pageLabelSet,e.numberOfPages]);var l=function(e){return Object(s.a)(n("kw-litb-page"),{pageNumber:e})},u=function(t,n){return function(){e.setOverlayMode(!1),e.goToPosition(t,{token:n}),e.setShowSearchModal(!1)}},d=function(e,t){return t?"..."+e+"...":n("kw-litb-page-not-included-in-sample")},f=function(t){return a[t]?a[t]:e.numberOfPages&&t>e.numberOfPages/2?n("kw-litb-back-matter"):n("kw-litb-front-matter")},m=function(e,t,n){return t?f(e):f(e)+" - "+n};return r.createElement(b,{renderSearchResultItem:function(t,o,a){if("keyword"in t)throw new Error("Wrong search component used.");var i,c=t[0],l=t[2],s=t[3],f=e.searchQuery!==l;return r.createElement("button",{"aria-label":(i=l,i+", "+n("kw-litb-search-result-item-guide")),className:"search-result-item-link","data-index":o,onClick:u(parseInt(c,10),s),ref:a,role:"menuitem",tabIndex:-1,disabled:!f},r.createElement("div",{dangerouslySetInnerHTML:{__html:m(parseInt(c,10),f,e.searchQuery)},className:"search-result-item-page"}),r.createElement("div",{className:E(f),dangerouslySetInnerHTML:{__html:d(l,f)}}))},ref:t})})),y=Object(i.b)((function(e){return{bookmarks:e.litbBook.bookmarks,numberOfPages:e.litbBook.numberOfPages,pageLabelSet:e.litbBook.pageLabelSet,searchQuery:e.search.searchQuery}}),(function(e){return{setOverlayMode:function(t){return e(Object(p.b)(p.a.SET_OVERLAY_MODE,t))},setShowSearchModal:function(t){return e(Object(p.b)(p.a.SET_SHOW_SEARCH_MODAL,t))}}}),null,{forwardRef:!0})(w),S=n(2),R=r.forwardRef((function(e,t){var n=Object(r.useRef)(null);Object(r.useImperativeHandle)(t,(function(){return{focusFirstActiveElement:function(){e.searchBarRef&&e.searchBarRef.focus()},focusLastActiveElement:function(){n.current&&n.current.focus()}}}));return r.createElement("div",{className:"search-body",role:"presentation",onKeyDown:function(t){if(e.searchBarRef&&n.current)if(o.e(t)&&t.shiftKey&&n.current.contains(t.target))t.preventDefault(),t.stopPropagation(),e.searchBarRef.focus();else if(o.e(t)&&e.searchBarRef.contains(t.target))t.preventDefault(),t.stopPropagation(),n.current.focus();else{var r=void 0;if(e.searchBarRef.contains(t.target)?r=e.searchBarRef.getMenuItems():n.current.contains(t.target)&&(r=n.current.getMenuItems()),r){var i=document.activeElement;if(i&&i.dataset.index){var c=parseInt(i.dataset.index,10);a.a(t,r,c)}}}}},e.renderType===S.a.YJHTML?r.createElement(h,{goToPosition:e.goToPosition,ref:n}):e.renderType===S.a.FixedFormatImage?r.createElement(y,{ref:n,goToPosition:e.goToPosition}):null)}))},292:function(e,t,n){"use strict";n.d(t,"a",(function(){return Y}));var r,o=n(4),a=n(13),i=n(0),c=n(21),l=n(224),s=n(122),u=n(77),d=n(7),f=n(2),b=n(1),m=n(225),p=n(249),O=n.n(p),h=n(15),g={},v=Object(o.b)((function(e){return{appType:e.appState.appType,bookRenderer:e.renderer.bookRenderer,isOverlayModeOn:e.chromeOverlay.isOverlayModeOn,renderType:e.appState.renderType,showDisplayOptions:e.chromeOverlay.showDisplayOptions}}),(function(e){return{setOverlayMode:function(t){return e(Object(a.b)(a.a.SET_OVERLAY_MODE,t))},setShowDisplayOptions:function(t){return e(Object(a.b)(a.a.SET_DISPLAY_OPTIONS,t))},setShowToolTips:function(t){return e(Object(a.b)(a.a.SET_SHOW_TOOL_TIPS,t))},setShowRatingsPopover:function(t){return e(Object(a.b)(a.a.SET_SHOW_RATINGS_POPOVER,t))}}}),null,{forwardRef:!0})((function(e){var t=Object(i.useState)(Object(m.a)()),n=t[0],r=t[1];g.isOverlayModeOn=e.isOverlayModeOn,g.showDisplayOptions=e.showDisplayOptions,g.currentReadingStatus=e.currentReadingStatus;var o,a,l=O()((function(){e.updateReadingLocation(),e.setShowToolTips(!1),e.setShowRatingsPopover(!1),(g.isOverlayModeOn||g.showDisplayOptions)&&(u.g?Object(u.h)(!1):g.currentReadingStatus!==c.c.END&&(e.setOverlayMode(!1),e.setShowDisplayOptions(!1)))}),100);return Object(i.useEffect)((function(){if(e.bookRenderer){var t=h.g(),n=h.f(),r=function(){if(h.l()&&h.o()&&e.bookRenderer&&void 0===e.bookRenderer.redraw){var t=h.g();"Portrait"===h.e()&&(t=-h.f());var n=document.documentElement.clientHeight-window.innerHeight;window.scrollTo(window.scrollX,window.scrollY+t-n)}},o=O()((function(){Object(u.h)(!0);var o=h.g(),a=h.f();h.b(!1);var i="mobile"===e.appType&&t!==o&&n!==a;if("desktop"===e.appType&&(t!==o||n!==a)||i){t=o,n=a;var l=Object(m.c)(e.scrollContainer),s=l.height,d=l.width,f=l.topOffset;if(e.bookRenderer&&e.bookRenderer.getStatus&&e.bookRenderer.getStatus()===c.d.STATUS_IDLE){var b=e.bookRenderer.getCurrentSettings();b.viewportHeight=s,b.viewportWidth=d,b.viewportTopOffset=f,e.bookRenderer.updateSettings(b)}}r()}));return window.addEventListener("resize",o),Object(m.b)(e.scrollContainer).addEventListener("scroll",l),function(){window.removeEventListener("resize",o),Object(m.b)(e.scrollContainer).removeEventListener("scroll",l)}}}),[e.bookRenderer,e.scrollContainer]),Object(i.useEffect)((function(){var e=O()((function(){r((function(e){var t=Object(m.a)();return e!==t?t:e}))}));return window.addEventListener("resize",e),function(){window.removeEventListener("resize",e)}}),[]),i.createElement("div",{id:"yj-html-render-container",className:(o=e.renderType,a="noselect kw-text-direction-normal",o===f.a.FixedFormatImage&&(a+=" scrollable-content-print"),a),onTouchMove:function(){e.showDisplayOptions&&e.setShowDisplayOptions(!1)},role:"document",style:{marginTop:n},onContextMenu:function(e){e.preventDefault()}},i.createElement("div",{id:"yj-html-render",ref:e.rendererContainerRef}))})),k=n(212),E=n(217),w=n(54),y=n(35),S=n(17),R=n(3),T=n(39),j=n(48),C=n(5),I=i.lazy((function(){return Object(C.q)((function(){return n.e(9).then(n.bind(null,439)).then((function(e){return{default:e.ConnectedStuccoChevrons}}))}))})),M={x:0,y:0},N=0,L=n(41),P=n(57),_=Object(o.b)((function(e){var t=e.renderer.bookRenderer?e.renderer.bookRenderer:void 0;return{appType:e.appState.appType,asin:e.appState.asin,bookOpen:e.litbBook.bookOpen,bookRenderer:t,contentMetadata:e.litbBook.contentMetadata,isOverlayModeOn:e.chromeOverlay.isOverlayModeOn,readingLocationData:e.litbBook.readingLocationData,renderType:e.appState.renderType,scrollDelta:e.renderer.scrollDelta,showInlineEndActions:e.chromeOverlay.showInlineEndActions,showDisplayOptions:e.chromeOverlay.showDisplayOptions,showSpinner:e.chromeOverlay.showSpinner}}),(function(e){return{setModalOverlay:function(t){return e(Object(L.e)(t))},setOverlayMode:function(t){return e(Object(a.b)(a.a.SET_OVERLAY_MODE,t))},setShowDisplayOptions:function(t){return e(Object(a.b)(a.a.SET_DISPLAY_OPTIONS,t))},setShowInlineEndActions:function(t){return e(Object(a.b)(a.a.SET_SHOW_INLINE_END_ACTIONS,t))},setShowSpinner:function(t){return e(Object(a.b)(a.a.SET_SHOW_SPINNER,t))},setShowToolTips:function(t){return e(Object(a.b)(a.a.SET_SHOW_TOOL_TIPS,t))},setScrollDelta:function(t){return e(Object(P.g)(t))}}}))((function(e){var t,n=Object(i.useRef)(null);Object(i.useEffect)((function(){if(e.bookRenderer&&e.bookOpen){var t=O()((function(){var t;if(w.a.triggerEvent(y.b.Book.LOADING_PAGE,!0),h.c(),e.bookRenderer&&e.bookRenderer.redraw&&e.readingLocationData){var n=null===(t=e.readingLocationData.currentPositionRange)||void 0===t?void 0:t.currentTopOfPage;e.bookRenderer.goToPosition(n||0),e.bookRenderer.redraw()}}));return window.addEventListener("resize",t),function(){window.removeEventListener("resize",t)}}}),[e.bookRenderer,e.bookOpen,e.readingLocationData]);var o=function(e){var t=k.a(e);t!==E.k&&t!==E.l||g(T.c.LEFT),t!==E.q&&t!==E.r||g(T.c.RIGHT)};Object(i.useEffect)((function(){return document.addEventListener("keyup",o),function(){document.removeEventListener("keyup",o)}}),[e.ariaBusy,e.contentMetadata,e.showSpinner,e.showInlineEndActions]),Object(i.useEffect)((function(){var t,n;e.scrollDelta>0?(null===(t=e.contentMetadata)||void 0===t?void 0:t.readingDirection)===f.b.RTL?g(T.c.LEFT):g(T.c.RIGHT):e.scrollDelta<0&&((null===(n=e.contentMetadata)||void 0===n?void 0:n.readingDirection)===f.b.RTL?g(T.c.RIGHT):g(T.c.LEFT)),e.setScrollDelta(0)}),[e.scrollDelta,null===(t=e.contentMetadata)||void 0===t?void 0:t.readingDirection]);var a=function(){e.bookRenderer&&e.bookRenderer.goToNextPage()},c=function(){return e.bookRenderer&&e.bookRenderer.goToPreviousPage(),!1},l=function(){return!!e.bookRenderer&&e.bookRenderer.hasNextPage()},s=function(t){var n=t.changedTouches[0].pageX,r=t.changedTouches[0].pageY,o=window.innerWidth||document.body.clientWidth,a=Math.max(1,Math.floor(.05*o)),i=Math.tan(.375*Math.PI),c=n-M.x,l=r-M.y,s=Math.abs(l/c);Math.abs(c)>a&&s<=i&&(e.setShowDisplayOptions(!1),e.setOverlayMode(!1),g(c<0?T.c.RIGHT:T.c.LEFT))},d=function(){Object(m.d)(),e.setShowInlineEndActions(!0)},p=function(){Object(m.e)(),e.setShowInlineEndActions(!1)},g=function(t){if(e.contentMetadata&&!e.ariaBusy&&!e.showSpinner&&e.asin&&e.renderType){var n=t===T.c.LEFT?y.b.Chevrons.CLICKED_LEFT_CHEVRON:y.b.Chevrons.CLICKED_RIGHT_CHEVRON;e.setOverlayMode(!1),e.setShowDisplayOptions(!1),e.setShowToolTips(!1),w.a.triggerEvent(n),e.contentMetadata.readingDirection===f.b.RTL?t===T.c.RIGHT?(e.showInlineEndActions?p():(Object(b.b)(e.metricsRef,e.renderType,e.asin),c()),Object(R.recordAction)(S.a.LITB_READER,S.a.RIGHT_CHEVRON_CLICKED)):(l()||"mobile"===e.appType?(Object(b.b)(e.metricsRef,e.renderType,e.asin),a()):d(),Object(R.recordAction)(S.a.LITB_READER,S.a.LEFT_CHEVRON_CLICKED)):t===T.c.RIGHT?(l()||"mobile"===e.appType?(Object(b.b)(e.metricsRef,e.renderType,e.asin),a()):d(),Object(R.recordAction)(S.a.LITB_READER,S.a.RIGHT_CHEVRON_CLICKED)):(e.showInlineEndActions?p():(Object(b.b)(e.metricsRef,e.renderType,e.asin),c()),Object(R.recordAction)(S.a.LITB_READER,S.a.LEFT_CHEVRON_CLICKED))}};return i.createElement(i.Fragment,null,i.createElement(i.Suspense,{fallback:i.createElement("div",null)},i.createElement(I,{ariaBusy:e.ariaBusy,hasNextPage:l,hasPreviousPage:function(){return!!e.bookRenderer&&e.bookRenderer.hasPreviousPage()},paginate:g})),i.createElement("div",{id:T.r,className:"kw-text-direction-normal"},i.createElement("div",{id:"s-overlay",className:"noselect",ref:n,onClick:function(t){var n=Object(u.e)(document.getElementById("s-render"),t);2===++N?(clearTimeout(r),N=0,e.bookRenderer&&e.bookRenderer.handleDoubleClick&&e.bookRenderer.handleDoubleClick(n.x,n.y)&&(e.setOverlayMode(!1),e.setShowDisplayOptions(!1),e.setModalOverlay(!1)),t.preventDefault()):r=window.setTimeout((function(){N=0,e.bookRenderer&&e.bookRenderer.handleClick&&e.bookRenderer.handleClick(n.x,n.y)?(e.setOverlayMode(!1),t.stopPropagation()):e.showDisplayOptions?e.setShowDisplayOptions(!1):e.setOverlayMode(!e.isOverlayModeOn),e.setModalOverlay(!1)}),j.a)},onTouchStart:function(e){M.x=e.changedTouches[0].pageX,M.y=e.changedTouches[0].pageY},onTouchEnd:s,onTouchCancel:s,role:"region","aria-hidden":"true"}),i.createElement("div",{id:"s-render",className:"noselect",ref:e.rendererContainerRef})))})),A=n(56),x=n(229),D=n(76),z=function(){return(z=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},B=function(e){return function(t){switch(t){case c.d.STATUS_IDLE:Object(b.g)(!0,e);break;case c.d.STATUS_ERROR:Object(b.g)(!1,e)}}},U={},F={},H=s.a,q=!1,W=n(6),K=n(79),Y=Object(o.b)((function(e){var t;return t=Object(K.b)(e.search.searchResults)&&e.search.searchResults.results?e.search.searchResults.results:e.search.searchResultItems,{appType:e.appState.appType,asin:e.appState.asin||"",revisionId:e.appState.revisionId||"undefined",bookOpen:e.litbBook.bookOpen,bookRenderer:e.renderer.bookRenderer,contentMetadata:e.litbBook.contentMetadata,displayOptions:e.renderer.displayOptions,interactionManager:e.appState.interactionManager,highlightSearchResult:e.search.searchResultItem,isOverlayModeOn:e.chromeOverlay.isOverlayModeOn,positionEvent:e.litbBook.positionEvent,searchPageTokens:e.search.searchPageTokens,searchQuery:e.search.searchQuery,searchResultItems:t,showDisplayOptions:e.chromeOverlay.showDisplayOptions,type:e.appState.renderType||f.a.Stucco}}),(function(e){return{setBookOpen:function(t){return e(Object(W.c)(t))},setBookRenderer:function(t){return e(Object(P.a)(t))},setEndOfSampleMessage:function(t){return e(Object(a.b)(a.a.SET_END_OF_SAMPLE_MESSAGE,t))},setShowInlineEndActions:function(t){return e(Object(a.b)(a.a.SET_SHOW_INLINE_END_ACTIONS,t))},setOverlayMode:function(t){return e(Object(a.b)(a.a.SET_OVERLAY_MODE,t))},setReadingLocationData:function(t){return e(Object(W.l)(t))},setShowDisplayOptions:function(t){return e(Object(a.b)(a.a.SET_DISPLAY_OPTIONS,t))},setShowSpinner:function(t){return e(Object(a.b)(a.a.SET_SHOW_SPINNER,t))},setZoomPercent:function(t,n){return e(Object(P.i)(t,n))}}}),null,{forwardRef:!0})((function(e){var t=Object(i.useState)(!1),n=t[0],r=t[1],o=Object(i.useRef)(null),a=Object(i.useRef)(new Map).current,p=Object(i.useState)(c.c.READING),O=p[0],h=p[1],g=e.capabilities&&e.capabilities&c.a.VerticalScrolling,k=e.capabilities&&e.capabilities&c.a.Paginated,E=Object(A.a)(),w=E.getLitbTranslation,y=E.translationsReady,S=Object(D.a)();U.currentReadingStatus=O,U.showDisplayOptions=e.showDisplayOptions,H=e.displayOptions.zoomPercent;var R=function(){e.bookRenderer&&e.bookRenderer.getReadingLocation&&e.bookRenderer.getReadingLocation().then((function(t){e.setReadingLocationData(t);var n=function(t){var n,r,o,a=-1;return(null===(n=t.currentPositionRange)||void 0===n?void 0:n.firstVisiblePid)?a=t.currentPositionRange.firstVisiblePid:e.type!==f.a.YJHTML&&(null===(r=t.currentPositionRange)||void 0===r?void 0:r.currentTopOfPage)&&(a=null===(o=t.currentPositionRange)||void 0===o?void 0:o.currentTopOfPage),a}(t);S.consumeContent({action:k?"Pagination":"Scrolling",context:"Reader",contentType:e.type.toString(),endPosition:n,startPosition:n})}))};F.updateReadingLocation=R,Object(i.useEffect)((function(){e.scrollContainer&&k&&(e.scrollContainer.style.overflow="visible hidden")}),[e.scrollContainer,k]),Object(i.useEffect)((function(){var t,n,i=o.current;if(!e.bookRenderer&&e.capabilities&&i&&!q){q=!0;g||"desktop"===e.appType?(Object(u.a)(),g&&Object(u.h)(!0)):Object(u.c)(),r(!1);var f=function(e,t,n){var r=Object(m.c)(n),o=r.height,a=r.width,i=r.topOffset;return z(z({},Object(s.b)(e,t)),{marginTop:30,marginRight:15,marginBottom:30,marginLeft:15,viewportHeight:o,viewportWidth:a,viewportTopOffset:i})}(e.displayOptions,e.capabilities,e.scrollContainer);e.bookProvider.createRenderer({asin:e.asin,rootElement:i,rendererCallBacks:{onExternalLinkClick:null===(t=e.interactionManager)||void 0===t?void 0:t.openExternalLink,onEndOfBook:I,onFontLoadingStatusChanged:(n=e.type,function(e){switch(e){case l.b.STATUS_LOADING_FONT_DONE:Object(b.f)(!0,n);break;case l.b.STATUS_LOADING_FONT_ERROR:Object(b.f)(!1,n)}}),onInitialization:B(e.type),onRendererStatusChanged:function(t){switch(t){case c.d.STATUS_LOADING:e.setAriaBusy(!0),e.setShowSpinner(!0);break;case c.d.STATUS_IDLE:e.setAriaBusy(!1),Object(b.h)(a,e.type,e.asin),e.setShowSpinner(!1),F.updateReadingLocation&&F.updateReadingLocation()}},onZoom:C},scrollContainer:e.scrollContainer},f).then((function(t){e.setBookRenderer(t)})).catch((function(e){Object(d.b)("PageRenderingError",e)}))}}),[e.bookRenderer,o.current,e.capabilities]);var T=Object(i.useCallback)((function(t){return j(t)||e.type===f.a.FixedFormatImage}),[e.type]),j=function(e){return e.height>0&&e.width>0};Object(i.useEffect)((function(){e.bookRenderer&&e.bookRenderer.setLocalizedStrings&&y&&n&&e.bookRenderer.setLocalizedStrings({genericSampleMessage:w("kw-litb-generic-sample-disclaimer"),getMissingPageMessage:function(e){return Object(x.a)(w("kw-litb-missing-sample-page-disclaimer"),{pageNumber:e.toString()})},getMissingPagesMessage:function(e,t){return Object(x.a)(w("kw-litb-missing-sample-pages-disclaimer"),{startPageNumber:e.toString(),endPageNumber:t.toString()})}})}),[e.bookRenderer,y,n]),Object(i.useEffect)((function(){var t=Object(m.c)(e.scrollContainer);e.bookRenderer&&e.bookRenderer.setDefaultWidth&&j(t)&&o.current&&n&&e.bookRenderer.setDefaultWidth(o.current.clientWidth)}),[e.bookRenderer,e.scrollContainer,o.current,n]),Object(i.useEffect)((function(){var t=Object(m.c)(e.scrollContainer);e.bookRenderer&&T(t)&&!n&&(e.bookRenderer.updateSettings(Object(s.c)(t.height,t.width,t.topOffset)),e.bookRenderer.clear&&e.bookRenderer.clear(),e.bookRenderer.initialize().then((function(){var t,n;e.setShowSpinner(!1),e.setBookOpen(!0),r(!0),q=!1,Object(b.e)(!0,e.type),S.openBook({asin:e.asin,assetId:"undefined",embeddedIdd:"undefined",startReadingPosition:(null===(t=e.contentMetadata)||void 0===t?void 0:t.srl)||0,endReadingPosition:(null===(n=e.contentMetadata)||void 0===n?void 0:n.srl)||0,format:e.type.toString(),revision:e.revisionId})})).catch((function(t){Object(b.e)(!1,e.type),Object(d.b)("PageRenderingError",t)})))}),[e.bookRenderer,o.current,T]),Object(i.useEffect)((function(){e.bookRenderer&&(e.bookRenderer.clear&&e.bookRenderer.clear(),e.setBookRenderer(void 0))}),[e.bookProvider]),Object(i.useEffect)((function(){e.bookRenderer&&e.bookRenderer.setSearchInfo&&e.bookRenderer.clearSearchHighlights&&(e.bookRenderer.clearSearchHighlights(),e.bookRenderer.setSearchInfo({query:e.searchQuery,tokens:e.searchPageTokens}))}),[e.searchPageTokens]),Object(i.useEffect)((function(){e.bookRenderer&&e.capabilities&&(g&&Object(u.h)(!0),e.bookRenderer.updateSettings(Object(s.b)(e.displayOptions,e.capabilities)))}),[e.displayOptions]),Object(i.useEffect)((function(){e.bookRenderer&&e.positionEvent&&e.bookRenderer.goToPosition(e.positionEvent.position,e.positionEvent.options)}),[e.positionEvent]),Object(i.useEffect)((function(){e.bookRenderer&&e.bookRenderer.highlightSearchResult&&e.highlightSearchResult&&e.bookRenderer.highlightSearchResult(e.highlightSearchResult)}),[e.highlightSearchResult]),Object(i.useEffect)((function(){e.bookRenderer&&e.bookRenderer.clearSearchHighlights&&!e.searchResultItems.length&&e.bookRenderer.clearSearchHighlights()}),[e.searchResultItems.length]);var C=function(t){e.setOverlayMode(!1),Math.abs(H-t)>.01&&e.setZoomPercent(t,!0)},I=function(t){U.currentReadingStatus===t&&U.currentReadingStatus!==c.c.END||(h(t),t!==c.c.END||U.showDisplayOptions?(e.setEndOfSampleMessage(!1),"desktop"===e.appType&&Object(m.e)()):(e.setOverlayMode(!0),e.setEndOfSampleMessage(!0),"desktop"===e.appType&&Object(m.d)()))};return g?i.createElement(v,{currentReadingStatus:O,updateReadingLocation:R,rendererContainerRef:o,scrollContainer:e.scrollContainer}):k?i.createElement(_,{ariaBusy:e.ariaBusy,metricsRef:a,rendererContainerRef:o}):null}))},295:function(e,t,n){"use strict";n.d(t,"a",(function(){return b}));var r=n(4),o=n(0),a=n(56),i=n(5),c=n(2),l=n(8),s=n(211),u=n(20),d=n(76),f=n(3),b=Object(r.b)((function(e){var t,n,r;return{appType:e.appState.appType,asin:e.appState.asin,currentBinding:null===(t=e.litbBook.litbBook)||void 0===t?void 0:t.binding,interactionManager:e.appState.interactionManager,kindleRelatedEditionInfo:null===(n=e.litbBook.litbBook)||void 0===n?void 0:n.kindleRelatedEditionInfo,printRelatedEditionInfo:null===(r=e.litbBook.litbBook)||void 0===r?void 0:r.printRelatedEditionInfo}}))((function(e){var t=Object(a.a)().getLitbTranslation,n=Object(d.a)(),r=function(t,r,a,s,u,d){if(void 0===d&&(d="Kindle"),r&&a){var b=Object(i.c)(r,a,s);return o.createElement("a",{key:u,href:b,onClick:function(t){var o;Object(f.recordCountMetric)("BookTabClick:"+d,1),n.emitInBookAction({action:"BookTabClick",context:"BookTab",value:d}),"desktop"===e.appType?(t.preventDefault(),Object(l.l)(r,s||"",Object(c.i)(a))):(null===(o=e.interactionManager)||void 0===o?void 0:o.anchorOnClick)&&e.interactionManager.anchorOnClick(b)(t)},className:(m=e.asin===r,p="book-type-tab",m&&(p+=" book-type-selected"),p)},t)}var m,p;return null},b=function(){var n,a,i;return o.createElement("div",{className:"book-type-tabs-group"},r(t(Object(c.f)("kindle_edition")),null===(n=e.kindleRelatedEditionInfo)||void 0===n?void 0:n.asin,null===(a=e.kindleRelatedEditionInfo)||void 0===a?void 0:a.format,null===(i=e.kindleRelatedEditionInfo)||void 0===i?void 0:i.revisionId),e.printRelatedEditionInfo?e.printRelatedEditionInfo.map((function(e,t){return r(e.binding,e.asin,e.format,"",t,"Print")})):null)};return o.createElement("div",{className:"book-type-tabs"},function(){var n,r,a,l,d,f;if(((null===(n=e.kindleRelatedEditionInfo)||void 0===n?void 0:n.asin)&&(null===(r=e.printRelatedEditionInfo)||void 0===r?void 0:r.length)||e.printRelatedEditionInfo&&e.printRelatedEditionInfo.length>1)&&Object(i.d)()!==u.a.KFW)return o.createElement(o.Fragment,null,function(){var n,r;return(null===(n=e.kindleRelatedEditionInfo)||void 0===n?void 0:n.asin)&&(null===(r=e.printRelatedEditionInfo)||void 0===r?void 0:r.length)?o.createElement("h2",{className:"book-type-tabs-title"},t("kw-litb-available-previews")):null}(),b());if((null===(a=e.kindleRelatedEditionInfo)||void 0===a?void 0:a.asin)||(null===(l=e.printRelatedEditionInfo)||void 0===l?void 0:l.length)){var m="";if((null===(d=e.printRelatedEditionInfo)||void 0===d?void 0:d.length)&&e.printRelatedEditionInfo[0].asin===e.asin?m=e.printRelatedEditionInfo[0].binding:(null===(f=e.kindleRelatedEditionInfo)||void 0===f?void 0:f.asin)===e.asin&&(m=t(Object(c.f)("kindle_edition"))),m){var p=Object(s.a)(t("kw-litb-book-type-single-tab-text"),{binding:m});return o.createElement("div",{className:"single-tab-text",dangerouslySetInnerHTML:{__html:p}})}}}())}))},296:function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var r=n(4),o=n(0),a=n(44),i=n(56),c=n(211),l=n(286),s=n(3),u=n(17),d=function(e,t){return"kindle_edition"===e.bindingSymbol?t("kw-litb-kindle"):e.binding},f=Object(r.b)((function(e){var t,n,r,o;return{productAsinPrice:null===(t=e.buyBox.bookOffer)||void 0===t?void 0:t.price,productEditionMetadata:null===(n=e.litbBook.litbBook)||void 0===n?void 0:n.productEditionMetadata,sampleEditionMetadata:null===(r=e.litbBook.litbBook)||void 0===r?void 0:r.sampleEditionMetadata,storeLink:null===(o=e.litbBook.litbBook)||void 0===o?void 0:o.productAsinStoreLink}}))((function(e){if(!(e.storeLink&&e.productEditionMetadata&&e.sampleEditionMetadata&&e.productAsinPrice))return null;var t=Object(i.a)().getLitbTranslation,n=a.c(e.storeLink,a.a("kwrp_li","en_nodl")),r=Object(c.a)(t("kw-litb-edition-not-available"),{storePath:n,requestedEdition:d(e.productEditionMetadata,t),requestedPublicationYear:e.productEditionMetadata.publicationYear,requestedPublisher:e.productEditionMetadata.publisherName,requestedPrice:e.productAsinPrice.displayString,shownEdition:d(e.sampleEditionMetadata,t),shownPublisher:e.sampleEditionMetadata.publisherName,shownPublicationYear:e.sampleEditionMetadata.publicationYear}),f=e.sampleEditionMetadata.binding?e.sampleEditionMetadata.binding.toLowerCase():"";return"hardcover"!==f&&"paperback"!==f||(Object(s.recordCountMetric)(u.a.PRINT_RELATED_EDITION_SHOWN,1),e.productEditionMetadata.publisherName!==e.sampleEditionMetadata.publisherName&&Object(s.recordCountMetric)(u.a.RELATED_EDITION_HAS_DIFFERENT_PUBLISHER,1)),o.createElement(l.a,{className:"edition",content:r,title:""})}))},297:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(4),o=n(0),a=n(240),i=Object(r.b)((function(e){return{interactionManager:e.appState.interactionManager}}))((function(e){var t=Object(o.useRef)(null);Object(o.useEffect)((function(){var n,r=null===(n=e.interactionManager)||void 0===n?void 0:n.anchorOnClick;t.current&&r&&t.current.querySelectorAll("a").forEach((function(e){Object(a.a)(e,r)}))}),[t.current]);var n={top:e.top?e.top+"px":0};return o.createElement("div",{className:"notice-list-container",ref:t,style:n},e.children)}))},298:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0),o=function(){return r.createElement("svg",{width:"20px",height:"16px",viewBox:"0 0 20 16",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},r.createElement("g",{id:"MShopLeftIcon-specs",stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},r.createElement("g",{id:"MShopLeftIcon-Group1",transform:"translate(-12.000000, -17.000000)",stroke:"#000000",strokeWidth:"2"},r.createElement("g",{id:"MShopLeftIcon-Group2",transform:"translate(10.000000, 13.000000)"},r.createElement("polyline",{id:"MShopLeftIcon-Rectangle",transform:"translate(7.500000, 12.000000) rotate(90.000000) translate(-7.500000, -12.000000) ",points:"14.5 8.5 7.5 15.5 0.5 8.5"}),r.createElement("line",{x1:"4.5",y1:"12",x2:"20.5",y2:"12",id:"MShopLeftIcon-Line",strokeLinecap:"square"})))))},a=n(76),i=function(e){var t=Object(a.a)();return r.createElement("button",{className:"mshop-back-button","aria-label":e.ariaLabel,onClick:function(n){var r;t.closeBook(),e.interactionManager&&e.interactionManager.goBack&&(null===(r=e.interactionManager)||void 0===r||r.goBack(n))}},r.createElement("span",{className:"mshop-back-icon"},r.createElement(o,null)))}},299:function(e,t,n){"use strict";n.d(t,"a",(function(){return v}));var r=n(4),o=n(13),a=n(0),i=n(262),c=n.n(i),l=n(270),s=n(230),u=n(431),d=n(56),f=n(3),b=n(1),m=n(2),p=n(76),O=function(){return(O=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},h=a.forwardRef((function(e,t){var n=Object(d.a)(),r=n.getLitbTranslation,o=n.translationsReady,i=Object(a.useRef)(null),h=Object(a.useRef)(null),g=Object(a.useMemo)((function(){var t;return function(e,t,n){return e?e.map((function(e){var r=O({},e);return t===m.a.FixedFormatImage&&r.label===u.SURPRISE_ME_LABEL&&(r.label=n[u.SURPRISE_ME_LABEL]),r})):null}(e.tableOfContents,e.renderType,((t={})[u.SURPRISE_ME_LABEL]=r("kw-litb-surprise-me"),t))}),[e.tableOfContents,e.renderType,o]),v=Object(a.useMemo)((function(){return function(e){return e?e.filter((function(e){return e.label&&e.position})):[]}(g)}),[g]),k=Object(a.useMemo)((function(){return function(e){for(var t=0;t<e.length;t++)if(!e[t].inSample)return t-1;return e.length>0&&e[0].inSample?e.length:-1}(v)}),[v]),E=Object(p.a)();Object(a.useEffect)((function(){var t=e.isOverlayModeOn?1:0;if(e.renderType){var n=Object(f.getSuccessMetricName)(Object(b.d)(b.a.TOC_SHOWN,e.renderType));Object(f.recordCountMetric)(n,t),Object(f.recordSessionsWithCountMetric)(n,t),Object(f.recordSessionsWithCountMetric)(b.a.TOC_SHOWN,t)}}),[e.isOverlayModeOn,e.renderType]),Object(a.useImperativeHandle)(t,(function(){return{focusFirstActiveElement:function(){i.current&&i.current.focus()},focusLastActiveElement:function(){h.current?h.current.focus():i.current&&i.current.focus()}}}));var w=function(t){var n=document.querySelectorAll("."+e.containerClassName+" .table-of-contents-chapter-link:enabled"),r=document.activeElement,o=parseInt(r.dataset.index,10);s.a(t,n,o)},y=function(t){return function(n){if(t&&!n.target.disabled){var r=document.querySelector(".book-card-scrollable-section");r&&Object(l.enableBodyScroll)(r),e.goToPosition(t,{focus:!0}),e.setModalOverlay(!1),e.setOverlayMode(!1),e.renderType&&(Object(f.recordCountMetric)(Object(b.d)(b.a.TOC_ITEM_CLICKED,e.renderType),1),E.emitInBookAction({action:b.a.TOC_ITEM_CLICKED,context:"TOC",value:""+t}))}}},S=function(e){if(-1!==k)return 0===e?i:e===k?h:void 0},R=function(){if(v&&!c()(v)){var e=-1;return a.createElement("ol",{id:"table-of-contents",className:"table-of-contents-inner","aria-labelledby":"side-panel-toc-button",role:"menu"},v.map((function(t,n){return e+=t.inSample?1:0,a.createElement("li",{className:"table-of-contents-chapter",key:n},function(e,t){return a.createElement("button",{className:"table-of-contents-chapter-link","data-index":t,disabled:!e.inSample,onClick:y(e.position),onKeyDown:w,onTouchEnd:y(e.position),role:"menuitem",ref:S(t),tabIndex:-1},e.label)}(t,t.inSample?e:void 0))})))}return a.createElement("div",{className:"table-of-contents-alternative-message"},r("kw-litb-toc-alternative-message"))};return a.createElement("section",{className:"table-of-contents-section",role:"complementary","aria-label":r("kw-litb-table-of-contents-menu")||"","aria-hidden":!e.isOverlayModeOn},a.createElement("h2",{className:"book-card-section-title"},r("kw-litb-toc-title")),R())})),g=n(41),v=Object(r.b)((function(e){return{isOverlayModeOn:e.chromeOverlay.isOverlayModeOn,renderType:e.appState.renderType,tableOfContents:e.litbBook.tableOfContents}}),(function(e){return{setOverlayMode:function(t){return e(Object(o.b)(o.a.SET_OVERLAY_MODE,t))},setModalOverlay:function(t){return e(Object(g.e)(t))}}}),null,{forwardRef:!0})(h)}}]);