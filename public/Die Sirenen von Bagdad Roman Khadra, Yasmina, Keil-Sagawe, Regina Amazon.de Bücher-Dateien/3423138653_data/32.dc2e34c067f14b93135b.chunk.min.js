/*! For license information please see 32.dc2e34c067f14b93135b.chunk.min.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[32],{434:function(e,t,n){"use strict";n.r(t),n.d(t,"mapDispatchToProps",(function(){return st})),n.d(t,"ConnectedReaderUiDesktop",(function(){return lt}));var o,i=n(4),r=n(13),a=n(0),c=n(262),s=n.n(c),l=n(210),u=n(21),d=n(217),p=n(212),h=n(40),f=n(15),b=n(268),m=function(){return a.createElement("svg",{width:"21px",height:"17px",viewBox:"0 0 21 17",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},a.createElement("g",{id:"P0-Redlines",stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},a.createElement("g",{id:"29_Breakpoints_999",transform:"translate(-27.000000, -100.000000)"},a.createElement("g",{id:"Center_ContentArea",transform:"translate(10.000000, 78.000000)"},a.createElement("g",{id:"Features"},a.createElement("g",{id:"Table-of-Contents",transform:"translate(16.000000, 19.000000)"},a.createElement("g",{id:"Icon_ToC"},a.createElement("rect",{id:"Background",x:"0",y:"0",width:"24",height:"24"}),a.createElement("g",{id:"Group-4",transform:"translate(1.000000, 3.000000)",fill:"#000000"},a.createElement("rect",{id:"Rectangle",x:"0",y:"0",width:"15",height:"1"}),a.createElement("rect",{id:"Rectangle-Copy",x:"0",y:"8",width:"15",height:"1"}),a.createElement("rect",{id:"Rectangle-Copy-4",x:"18",y:"8",width:"3",height:"1"}),a.createElement("rect",{id:"Rectangle-Copy-6",x:"18",y:"16",width:"3",height:"1"}),a.createElement("rect",{id:"Rectangle-Copy-5",x:"18",y:"0",width:"3",height:"1"}),a.createElement("rect",{id:"Rectangle-Copy-2",x:"0",y:"16",width:"15",height:"1"})))))))))},v=n(247),E=function(e){return a.createElement(l.a,{in:e.show,timeout:200,classNames:"tool-tip"},a.createElement("div",{className:(t=e.className,t?"tool-tip "+t:"tool-tip"),role:"tooltip",id:e.id,"aria-live":"polite","aria-hidden":!e.show||void 0},e.message));var t},g=[],O="ResizeObserver loop completed with undelivered notifications.";!function(e){e.BORDER_BOX="border-box",e.CONTENT_BOX="content-box",e.DEVICE_PIXEL_CONTENT_BOX="device-pixel-content-box"}(o||(o={}));var w,y=function(){function e(e,t,n,o){return this.x=e,this.y=t,this.width=n,this.height=o,this.top=this.y,this.left=this.x,this.bottom=this.top+this.height,this.right=this.left+this.width,Object.freeze(this)}return e.prototype.toJSON=function(){var e=this;return{x:e.x,y:e.y,top:e.top,right:e.right,bottom:e.bottom,left:e.left,width:e.width,height:e.height}},e.fromRect=function(t){return new e(t.x,t.y,t.width,t.height)},e}(),T=function(e){return e instanceof SVGElement&&"getBBox"in e},k=function(e){if(T(e)){var t=e.getBBox(),n=t.width,o=t.height;return!n&&!o}var i=e,r=i.offsetWidth,a=i.offsetHeight;return!(r||a||e.getClientRects().length)},C=function(e){var t,n,o=null===(n=null===(t=e)||void 0===t?void 0:t.ownerDocument)||void 0===n?void 0:n.defaultView;return!!(o&&e instanceof o.Element)},B="undefined"!=typeof window?window:{},S=new WeakMap,x=/auto|scroll/,R=/^tb|vertical/,j=/msie|trident/i.test(B.navigator&&B.navigator.userAgent),L=function(e){return parseFloat(e||"0")},M=function(e,t,n){return void 0===e&&(e=0),void 0===t&&(t=0),void 0===n&&(n=!1),Object.freeze({inlineSize:(n?t:e)||0,blockSize:(n?e:t)||0})},_=Object.freeze({devicePixelContentBoxSize:M(),borderBoxSize:M(),contentBoxSize:M(),contentRect:new y(0,0,0,0)}),N=function(e,t){if(void 0===t&&(t=!1),S.has(e)&&!t)return S.get(e);if(k(e))return S.set(e,_),_;var n=getComputedStyle(e),o=T(e)&&e.ownerSVGElement&&e.getBBox(),i=!j&&"border-box"===n.boxSizing,r=R.test(n.writingMode||""),a=!o&&x.test(n.overflowY||""),c=!o&&x.test(n.overflowX||""),s=o?0:L(n.paddingTop),l=o?0:L(n.paddingRight),u=o?0:L(n.paddingBottom),d=o?0:L(n.paddingLeft),p=o?0:L(n.borderTopWidth),h=o?0:L(n.borderRightWidth),f=o?0:L(n.borderBottomWidth),b=d+l,m=s+u,v=(o?0:L(n.borderLeftWidth))+h,E=p+f,g=c?e.offsetHeight-E-e.clientHeight:0,O=a?e.offsetWidth-v-e.clientWidth:0,w=i?b+v:0,C=i?m+E:0,B=o?o.width:L(n.width)-w-O,N=o?o.height:L(n.height)-C-g,A=B+b+O+v,I=N+m+g+E,P=Object.freeze({devicePixelContentBoxSize:M(Math.round(B*devicePixelRatio),Math.round(N*devicePixelRatio),r),borderBoxSize:M(A,I,r),contentBoxSize:M(B,N,r),contentRect:new y(d,s,B,N)});return S.set(e,P),P},A=function(e,t,n){var i=N(e,n),r=i.borderBoxSize,a=i.contentBoxSize,c=i.devicePixelContentBoxSize;switch(t){case o.DEVICE_PIXEL_CONTENT_BOX:return c;case o.BORDER_BOX:return r;default:return a}},I=function(e){var t=N(e);this.target=e,this.contentRect=t.contentRect,this.borderBoxSize=[t.borderBoxSize],this.contentBoxSize=[t.contentBoxSize],this.devicePixelContentBoxSize=[t.devicePixelContentBoxSize]},P=function(e){if(k(e))return 1/0;for(var t=0,n=e.parentNode;n;)t+=1,n=n.parentNode;return t},z=function(){var e=1/0,t=[];g.forEach((function(n){if(0!==n.activeTargets.length){var o=[];n.activeTargets.forEach((function(t){var n=new I(t.target),i=P(t.target);o.push(n),t.lastReportedSize=A(t.target,t.observedBox),i<e&&(e=i)})),t.push((function(){n.callback.call(n.observer,o,n.observer)})),n.activeTargets.splice(0,n.activeTargets.length)}}));for(var n=0,o=t;n<o.length;n++){(0,o[n])()}return e},D=function(e){g.forEach((function(t){t.activeTargets.splice(0,t.activeTargets.length),t.skippedTargets.splice(0,t.skippedTargets.length),t.observationTargets.forEach((function(n){n.isActive()&&(P(n.target)>e?t.activeTargets.push(n):t.skippedTargets.push(n))}))}))},H=function(){var e,t=0;for(D(t);g.some((function(e){return e.activeTargets.length>0}));)t=z(),D(t);return g.some((function(e){return e.skippedTargets.length>0}))&&("function"==typeof ErrorEvent?e=new ErrorEvent("error",{message:O}):((e=document.createEvent("Event")).initEvent("error",!1,!1),e.message=O),window.dispatchEvent(e)),t>0},W=[],F=function(e){if(!w){var t=0,n=document.createTextNode("");new MutationObserver((function(){return W.splice(0).forEach((function(e){return e()}))})).observe(n,{characterData:!0}),w=function(){n.textContent=""+(t?t--:t++)}}W.push(e),w()},U=0,q={attributes:!0,characterData:!0,childList:!0,subtree:!0},Y=["resize","load","transitionend","animationend","animationstart","animationiteration","keyup","keydown","mouseup","mousedown","mouseover","mouseout","blur","focus"],V=function(e){return void 0===e&&(e=0),Date.now()+e},X=!1,G=new(function(){function e(){var e=this;this.stopped=!0,this.listener=function(){return e.schedule()}}return e.prototype.run=function(e){var t=this;if(void 0===e&&(e=250),!X){X=!0;var n,o=V(e);n=function(){var n=!1;try{n=H()}finally{if(X=!1,e=o-V(),!U)return;n?t.run(1e3):e>0?t.run(e):t.start()}},F((function(){requestAnimationFrame(n)}))}},e.prototype.schedule=function(){this.stop(),this.run()},e.prototype.observe=function(){var e=this,t=function(){return e.observer&&e.observer.observe(document.body,q)};document.body?t():B.addEventListener("DOMContentLoaded",t)},e.prototype.start=function(){var e=this;this.stopped&&(this.stopped=!1,this.observer=new MutationObserver(this.listener),this.observe(),Y.forEach((function(t){return B.addEventListener(t,e.listener,!0)})))},e.prototype.stop=function(){var e=this;this.stopped||(this.observer&&this.observer.disconnect(),Y.forEach((function(t){return B.removeEventListener(t,e.listener,!0)})),this.stopped=!0)},e}()),J=function(e){!U&&e>0&&G.start(),!(U+=e)&&G.stop()},Z=function(){function e(e,t){this.target=e,this.observedBox=t||o.CONTENT_BOX,this.lastReportedSize={inlineSize:0,blockSize:0}}return e.prototype.isActive=function(){var e,t=A(this.target,this.observedBox,!0);return e=this.target,T(e)||function(e){switch(e.tagName){case"INPUT":if("image"!==e.type)break;case"VIDEO":case"AUDIO":case"EMBED":case"OBJECT":case"CANVAS":case"IFRAME":case"IMG":return!0}return!1}(e)||"inline"!==getComputedStyle(e).display||(this.lastReportedSize=t),this.lastReportedSize.inlineSize!==t.inlineSize||this.lastReportedSize.blockSize!==t.blockSize},e}(),K=function(e,t){this.activeTargets=[],this.skippedTargets=[],this.observationTargets=[],this.observer=e,this.callback=t},Q=new WeakMap,$=function(e,t){for(var n=0;n<e.length;n+=1)if(e[n].target===t)return n;return-1},ee=function(){function e(){}return e.connect=function(e,t){var n=new K(e,t);Q.set(e,n)},e.observe=function(e,t,n){var o=Q.get(e),i=0===o.observationTargets.length;$(o.observationTargets,t)<0&&(i&&g.push(o),o.observationTargets.push(new Z(t,n&&n.box)),J(1),G.schedule())},e.unobserve=function(e,t){var n=Q.get(e),o=$(n.observationTargets,t),i=1===n.observationTargets.length;o>=0&&(i&&g.splice(g.indexOf(n),1),n.observationTargets.splice(o,1),J(-1))},e.disconnect=function(e){var t=this,n=Q.get(e);n.observationTargets.slice().forEach((function(n){return t.unobserve(e,n.target)})),n.activeTargets.splice(0,n.activeTargets.length)},e}(),te=function(){function e(e){if(0===arguments.length)throw new TypeError("Failed to construct 'ResizeObserver': 1 argument required, but only 0 present.");if("function"!=typeof e)throw new TypeError("Failed to construct 'ResizeObserver': The callback provided as parameter 1 is not a function.");ee.connect(this,e)}return e.prototype.observe=function(e,t){if(0===arguments.length)throw new TypeError("Failed to execute 'observe' on 'ResizeObserver': 1 argument required, but only 0 present.");if(!C(e))throw new TypeError("Failed to execute 'observe' on 'ResizeObserver': parameter 1 is not of type 'Element");ee.observe(this,e,t)},e.prototype.unobserve=function(e){if(0===arguments.length)throw new TypeError("Failed to execute 'unobserve' on 'ResizeObserver': 1 argument required, but only 0 present.");if(!C(e))throw new TypeError("Failed to execute 'unobserve' on 'ResizeObserver': parameter 1 is not of type 'Element");ee.unobserve(this,e)},e.prototype.disconnect=function(){ee.disconnect(this)},e.toString=function(){return"function ResizeObserver () { [polyfill code] }"},e}(),ne=n(248),oe=n.n(ne),ie=n(2),re=n(35),ae=n(39),ce=n(54),se=n(269),le=n(56),ue=function(e){return a.createElement("div",{role:"banner",className:"book-title-overlay-container noselect"},a.createElement("h1",{className:"book-title"},e.bookTitle))},de=n(211),pe=function(e){var t,n=Object(le.a)().getLitbTranslation,o=(t=e.readingLocationData)&&t.currentPositionRange&&t.maximumPosition&&"number"==typeof t.minimumPosition?Math.round(t.currentPositionRange.currentTopOfPage/t.maximumPosition*100):-1,i=Object(de.a)(n("kw-litb-percent-of-sample"),{percent:""+o});return o>=0?a.createElement("div",{className:"litb-reading-location"},a.createElement("div",{className:"reading-loc-element reading-loc-percent"},i)):null},he=n(295),fe=n(292),be=n(299),me=a.forwardRef((function(e,t){var n=Object(le.a)().getLitbTranslation;return a.createElement(a.Fragment,null,a.createElement("h2",{className:"litb-content-toc-title"},n("kw-litb-side-panel-toc-header")),a.createElement(be.a,{containerClassName:ae.j,goToPosition:e.goToPosition,ref:t}))})),ve=n(290),Ee=a.forwardRef((function(e,t){return a.createElement(ve.a,{key:"aa-body",ref:t,showDisplayOptions:!0})})),ge=n(291),Oe=n(119),we=n(225),ye=n(8),Te=n(260),ke=n(5),Ce=n(296),Be=n(289),Se=n(297),xe=n(287),Re=n(298),je=n(37),Le=n(78),Me=n(20),_e=function(e){return a.createElement("svg",{id:"BackIcon",width:"10px",height:"18px",viewBox:"0 0 10 18",version:"1.1",xmlns:"http://www.w3.org/2000/svg",className:e.className},a.createElement("g",{id:"Chrome_Mobile",stroke:"none",strokeWidth:"1",fill:"none","fill-fule":"evenodd",strokeLinecap:"round",strokeLinejoin:"round"},a.createElement("g",{id:"Mobile_Chrome",transform:"translate(-15.000000, -107.000000)",stroke:"#000000",strokeWidth:"1.3"},a.createElement("g",{id:"TopChrome",transform:"translate(0.000000, 94.000000)"},a.createElement("g",{id:"Librarylink",transform:"translate(16.000000, 13.000000)"},a.createElement("polyline",{id:"Back-to-Library-Icon",transform:"translate(4.000000, 9.000000) rotate(90.000000) translate(-4.000000, -9.000000) ",points:"-4 5 4 13 12 5"}))))))},Ne=function(){return a.createElement("svg",{id:"AaMenuIcon",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},a.createElement("g",{fill:"none",fillRule:"evenodd",transform:"translate(1 5)"},a.createElement("path",{fill:"#000",d:"M5.44896,0.000264 L0,14.520264 L1.188,14.520264 L2.78608,9.935464 L9.3412,9.935464 L10.93928,14.520264 L12.18888,14.520264 L6.73992,0.000264 L5.44896,0.000264 Z M6.0632,1.270104 L8.97248,8.931384 L3.17504,8.931384 L6.0632,1.270104 Z"}),a.createElement("g",{transform:"translate(13.2 3.08)"},a.createElement("polygon",{points:"7.92 11.341 7.92 .505 .013 .505 .013 11.341 7.92 11.341"}),a.createElement("path",{fill:"#000",d:"M3.2494,10.27664 C3.7686,10.27664 4.32828,10.17104 4.92932,9.95896 C5.53036,9.74776 6.13756,9.45032 6.75268,9.06752 L6.75268,6.50672 C5.83748,6.2612 4.94956,6.13888 4.0898,6.13888 C2.17756,6.13888 1.22188,6.87632 1.22188,8.3512 C1.22188,8.97952 1.39172,9.45736 1.73404,9.78472 C2.0746,10.11296 2.5806,10.27664 3.2494,10.27664 L3.2494,10.27664 Z M6.87588,11.11616 L6.77292,9.92816 C5.59812,10.87064 4.36964,11.34144 3.08572,11.34144 C2.14324,11.34144 1.39612,11.07216 0.8426,10.53272 C0.28908,9.99328 0.01276,9.27256 0.01276,8.37144 C0.01276,7.3744 0.3542,6.58944 1.03708,6.01568 C1.71996,5.44192 2.64836,5.15504 3.82316,5.15504 C4.73748,5.15504 5.71428,5.31256 6.75268,5.62584 L6.75268,3.90544 C6.75268,3.07296 6.55468,2.47544 6.15868,2.11288 C5.7618,1.7512 5.1062,1.56992 4.19188,1.56992 C3.09892,1.56992 1.93116,1.78904 0.6886,2.22552 L0.6886,1.2628 C1.2078,1.03048 1.79476,0.84656 2.45036,0.71016 C3.10596,0.57376 3.74748,0.50512 4.3758,0.50512 C5.57788,0.50512 6.46932,0.75768 7.04924,1.2628 C7.63004,1.7688 7.92044,2.53264 7.92044,3.55696 L7.92044,11.11616 L6.87588,11.11616 Z"}))))},Ae=function(e){return a.createElement("svg",{id:"SearchIcon",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",className:e.className},a.createElement("path",{fill:"none",stroke:"#000",d:"M13.2887 6.8943C13.2887 10.4263 10.4257 13.2883 6.8947 13.2883 3.3627 13.2883.4997 10.4263.4997 6.8943.4997 3.3623 3.3627.5003 6.8947.5003 10.4257.5003 13.2887 3.3623 13.2887 6.8943zM10.5186 11.7195L15.2986 16.4995",transform:"translate(4 4)"}))},Ie=function(){return a.createElement("svg",{id:"TableOfContentIcon",width:"20px",height:"18px",viewBox:"0 0 20 18",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},a.createElement("g",{id:"Page-1",stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},a.createElement("g",null,a.createElement("rect",{id:"Rectangle",fillOpacity:"0",fill:"#FFFFFF",x:"0",y:"0",width:"20",height:"18"}),a.createElement("circle",{id:"Oval-Copy-2",stroke:"#212121",strokeWidth:"0.5",fill:"#212121",cx:"18",cy:"16",r:"1"}),a.createElement("circle",{id:"Oval-Copy",stroke:"#212121",strokeWidth:"0.5",fill:"#212121",cx:"18",cy:"9",r:"1"}),a.createElement("circle",{id:"Oval",stroke:"#212121",strokeWidth:"0.5",fill:"#212121",cx:"18",cy:"2",r:"1"}),a.createElement("line",{x1:"1",y1:"16",x2:"10",y2:"16",id:"Path-2-Copy-2",stroke:"#212121",strokeWidth:"1.3",strokeLinecap:"round",strokeLinejoin:"round"}),a.createElement("line",{x1:"1",y1:"9",x2:"13",y2:"9",id:"Path-2-Copy",stroke:"#212121",strokeWidth:"1.3",strokeLinecap:"round",strokeLinejoin:"round"}),a.createElement("line",{x1:"1",y1:"2",x2:"10",y2:"2",id:"Path-2",stroke:"#212121",strokeWidth:"1.3",strokeLinecap:"round",strokeLinejoin:"round"}))))},Pe=function(e){var t=e.id,n=e.className,o=e.icon,i=e.text,r=e.tooltipText,c=e.onclick;return a.createElement("button",{id:t,className:["chrome-top-bar-button",n].join(" "),onClick:c,title:r},o&&a.createElement("div",{className:"chrome-top-bar-button-icon"},o),o&&i&&a.createElement("div",{className:"chrome-button-text-icon-spacing"}),i&&a.createElement("div",{className:"chrome-top-bar-button-text"},i))},ze=n(3),De=n(17),He=function(){return(He=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},We=function(){this.isHidden=!1,this.shouldHideAutomatically=!0,this.selectedOption=null,this.optionsStatus=new Map([])},Fe=function(e,t){return!0===e.optionsStatus.get(t)},Ue=function(e){var t=e.title,n=e.styles,o=e.topBarStatus,i=e.setTopBarStatus,r=Object(le.a)().getLitbTranslation,c=a.createElement(_e,null),s=a.createElement(Ie,null),l=a.createElement(Ae,null),u=a.createElement(Ne,null),d=Object(a.useState)(0),p=d[0],h=d[1],f=Object(a.useState)(0),b=f[0],m=f[1],v=Object(ke.d)()===Me.a.KFW,E=r(v?"kw-litb-go-to-library":"kw-litb-go-to-store");qe((function(){i(He(He({},o),{selectedOption:null,isHidden:!1,shouldHideAutomatically:!0}))}));var g=function(e,t){t&&(e!==o.selectedOption?(i(He(He({},o),{selectedOption:e,shouldHideAutomatically:!1})),Object(ze.recordCountMetric)(De.a.CHROME_TOP_BAR_SELECT_OPTION+e,1)):i(He(He({},o),{selectedOption:null})))};Object(a.useEffect)((function(){if(o.shouldHideAutomatically){var e=setTimeout((function(){o.shouldHideAutomatically&&null===o.selectedOption&&i(He(He({},o),{isHidden:!0}))}),5e3);return function(){return clearTimeout(e)}}}),[o.shouldHideAutomatically,o.isHidden]);var O=function(){i(He(He({},o),{shouldHideAutomatically:!1,isHidden:!1}))},w=function(){null===o.selectedOption&&i(He(He({},o),{shouldHideAutomatically:!0}))},y=Object(a.useMemo)((function(){return o.isHidden?"hidden":""}),[o.isHidden]);Object(a.useEffect)((function(){var e,t,n,o,i=null!=(t=null===(e=document.getElementById("chrome-top-bar-back-button"))||void 0===e?void 0:e.getBoundingClientRect().width)?t:0,r=null!=(o=null===(n=document.getElementById("chrome-top-bar-options"))||void 0===n?void 0:n.getBoundingClientRect().width)?o:0;if(i!==r){var a=i>r?i:r;h(a),m(a)}}));var T=function(e,t){return[o.selectedOption===e?"selected":"",t?"":"hidden"].join(" ")};return a.createElement("div",{id:"chrome-top-bar",onMouseOut:w,onBlur:w,onMouseOver:O,onFocus:O,style:n},a.createElement("div",{id:"chrome-top-bar-container",className:y},a.createElement("div",{style:{minWidth:p+"px"}},a.createElement(Pe,{id:"chrome-top-bar-back-button",icon:c,text:E,tooltipText:E,onclick:function(){Object(ze.recordCountMetric)(v?De.a.CHROME_TOP_BAR_BACK_TO_LIBRARY:De.a.CHROME_TOP_BAR_BACK_TO_STORE,1),Object(ye.c)(v)}})),a.createElement("div",{id:"chrome-top-bar-title"},a.createElement("div",null,t)),a.createElement("div",{style:{minWidth:b+"px"}},a.createElement("div",{id:"chrome-top-bar-options"},a.createElement(Pe,{id:"chrome-top-bar-option-"+"TOC".toLowerCase(),icon:s,tooltipText:r("kw-litb-toc-title"),className:T("TOC",Fe(o,"TOC")),onclick:function(){return g("TOC",Fe(o,"TOC"))}}),a.createElement(Pe,{id:"chrome-top-bar-option-"+"SEARCH".toLowerCase(),icon:l,tooltipText:r("kw-litb-side-panel-tool-tip-search-button"),className:T("SEARCH",Fe(o,"SEARCH")),onclick:function(){return g("SEARCH",Fe(o,"SEARCH"))}}),a.createElement(Pe,{id:"chrome-top-bar-option-"+"AA_MENU".toLowerCase(),icon:u,tooltipText:r("kw-litb-side-panel-aa-header"),className:T("AA_MENU",Fe(o,"AA_MENU")),onclick:function(){return g("AA_MENU",Fe(o,"AA_MENU"))}})))))},qe=function(e){var t=document.getElementById(ae.r);t&&(t.onclick=e);var n=document.getElementById(ae.t);n&&(n.onclick=e)},Ye=n(288),Ve=n(257),Xe=n(76),Ge=n(1),Je=function(){return(Je=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},Ze=a.lazy((function(){return Object(ke.q)((function(){return n.e(31).then(n.bind(null,432)).then((function(e){return{default:e.SidePanel}}))}))})),Ke=function(e,t){if(e===ie.a.Stucco){var n="paginated-end-actions";return n+=t?" paginated-end-actions-show":" paginated-end-actions-hide"}return null},Qe=!1,$e=0,et=function(){var e="litb-footer";return f.q()&&(e+=" litb-footer-ipad"),e},tt=a.lazy((function(){return Object(ke.q)((function(){return n.e(8).then(n.bind(null,437)).then((function(e){return{default:e.ConnectedInlineEndActions}}))}))})),nt=function(e){var t=document.getElementById(ae.o);t&&(t.onwheel=e);var n=document.getElementById(ae.n);n&&(n.onclick=e);var o=document.getElementById(ae.m);o&&(o.onclick=e)},ot=n(6),it=n(41),rt=n(33),at=n(45),ct=n(57),st=function(e){return{setContentHeightWithoutBuyBox:function(t){return e(Object(rt.c)(t))},setShowInlineEndActions:function(t){return e(Object(r.b)(r.a.SET_SHOW_INLINE_END_ACTIONS,t))},setModalOverlay:function(t){return e(Object(it.e)(t))},setOverlayMode:function(t){return e(Object(r.b)(r.a.SET_OVERLAY_MODE,t))},setPositionEvent:function(t){return e(Object(ot.k)(t))},setScrollDelta:function(t){return e(Object(ct.g)(t))},setShowDisplayOptions:function(t){return e(Object(r.b)(r.a.SET_DISPLAY_OPTIONS,t))},setShowSpinner:function(t){return e(Object(r.b)(r.a.SET_SHOW_SPINNER,t))},setShowToolTips:function(t){return e(Object(r.b)(r.a.SET_SHOW_TOOL_TIPS,t))},reinitializeLitb:function(){return e(Object(at.b)())}}},lt=Object(i.b)((function(e){return{bookOpen:e.litbBook.bookOpen,contentMetadata:e.litbBook.contentMetadata,interactionManager:e.appState.interactionManager,isOverlayModeOn:e.chromeOverlay.isOverlayModeOn,tableOfContents:e.litbBook.tableOfContents,litbBook:e.litbBook.litbBook,readingLocationData:e.litbBook.readingLocationData,renderType:e.appState.renderType,rendererCapabilities:e.renderer.capabilities,showDisplayOptions:e.chromeOverlay.showDisplayOptions,showErrorModal:e.chromeOverlay.showErrorModal,showInlineBuyBox:e.buyBox.showInlineBuyBox,showInlineEndActions:e.chromeOverlay.showInlineEndActions,showSpinner:e.chromeOverlay.showSpinner,showToolTips:e.chromeOverlay.showToolTips,showUpsellWidget:e.renderer.displayOptions.showUpsellWidget}}),st)((function(e){var t,n=Object(le.a)(),o=n.textDirection,i=n.getLitbTranslation,r=Object(Le.a)().isWeblabEnabled,c=Object(a.useRef)(null),g=Object(a.useRef)(null),O=Object(a.useState)(!0),w=O[0],y=O[1],T=Object(a.useRef)(null),k=Object(a.useState)(null),C=k[0],B=k[1],S=Object(a.useRef)(null),x=Object(a.useState)(""),R=x[0],j=x[1],L=Object(a.useState)(!0),M=L[0],_=L[1],N=Object(a.useState)(!1),A=N[0],I=N[1],P=Object(a.useState)(!1),z=P[0],D=P[1],H=Object(a.useState)(!1),W=H[0],F=H[1],U=Object(a.useRef)(null),q=Object(Ve.a)().setLastPositionRead,Y=Object(a.useState)(new We),V=Y[0],X=Y[1],G=Object(Xe.a)();Qe=e.showInlineBuyBox,Object(a.useEffect)((function(){I(!0)}),[]),Object(a.useEffect)((function(){var e=function(e){var t=p.a(e);t!==d.g&&t!==d.h||Ae()};window.addEventListener("keyup",e);var t=document.querySelector("#mainContainer"),n=function(e){("mainContainer"===e.target.id||e.target.classList.contains("litb-reader-main")||e.target.classList.contains("litb-content-desktop"))&&Ae()};return t&&t.addEventListener("click",n),function(){t&&t.removeEventListener("click",n),window.removeEventListener("keyup",e)}})),Object(a.useEffect)((function(){var t;C&&(F(!e.showingCoverImage),!e.showingCoverImage&&e.bookOpen&&(e.setShowInlineEndActions(!1),Object(we.e)(),ne((null===(t=e.contentMetadata)||void 0===t?void 0:t.srl)||0)))}),[e.showingCoverImage,e.bookOpen,C,null===(t=e.contentMetadata)||void 0===t?void 0:t.srl]),Object(a.useEffect)((function(){C&&y(!1)}),[C]),Object(a.useEffect)((function(){D(!1),_(!0)}),[e.litbBook]),Object(a.useEffect)((function(){if(S.current){var e=new te((function(e){requestAnimationFrame((function(){!function(e,t){var n=e[0].borderBoxSize[0].blockSize;Qe||($e=n);var o="\n    @keyframes slide-up {\n      0%   { transform: translateY(0px); }\n      100% { transform: translateY("+-1*$e+"px); }\n    }\n  ",i="\n    @keyframes slide-down {\n      0%   { transform: translateY("+-1*$e+"px); }\n      100% { transform: translateY(0px); }\n    }\n  ";t("\n    "+(Qe?i:o)+"\n\n    "+(Qe?o:i)+"\n  ")}(e,j)}))}));return e.observe(S.current,{box:"border-box"}),function(){e.disconnect()}}}),[S.current]),Object(a.useEffect)((function(){var t=function(t){var n=p.a(t);n!==d.g&&n!==d.h||e.setOverlayMode(!e.isOverlayModeOn)};return!e.isOverlayModeOn&&e.contentMetadata&&(e.contentMetadata.readingDirection===ie.b.RTL?g.current&&g.current.focus():c.current&&c.current.focus()),document.addEventListener("keyup",t),function(){document.removeEventListener("keyup",t)}}),[e.isOverlayModeOn]),Object(a.useEffect)((function(){!e.isOverlayModeOn&&T.current&&T.current.setShowPanel(void 0)}),[e.isOverlayModeOn]),Object(a.useEffect)((function(){var t;if(e.readingLocationData&&e.readingLocationData.currentPositionRange){var n=e.readingLocationData.currentPositionRange.currentTopOfPage<=0;_(n);var o=null===(t=e.readingLocationData.currentPositionRange)||void 0===t?void 0:t.firstVisiblePid;q(o)}}),[e.readingLocationData]),Object(a.useEffect)((function(){var e=function(e){if("string"==typeof e.data&&Object(ye.h)(e.data)){var t=JSON.parse(e.data);t.command===ye.a.CLOSE_LITB&&Ae(t.messagedParent)}};return window.addEventListener("message",e),function(){window.removeEventListener("message",e)}}),[]);Object(a.useEffect)((function(){var t,n;e.rendererCapabilities&&(t=e.rendererCapabilities,n=new Map([["TOC",Object(Ye.c)(t,e.contentMetadata)],["SEARCH",Object(Ye.b)(t)],["AA_MENU",Object(Ye.a)(t)]]),X(Je(Je({},V),{optionsStatus:n})))}),[e.rendererCapabilities]),Object(se.a)((function(){ce.a.triggerEvent(re.b.Book.LOADING_PAGE,!1)}));var J,Z,K,Q,$,ee,ne=function(t,n){e.setPositionEvent({position:t,options:n})},de=function(e,t,n){be(Ge.a.SEARCH_PRERENDERED,e?1:0),be(Ge.a.TOC_PRERENDERED,t?1:0),be(Ge.a.DISPLAY_OPTIONS_PRERENDERED,n?1:0)},be=function(t,n){if(Object(ze.recordSessionsWithCountMetric)(t,n),e.renderType){var o=Object(ze.getSuccessMetricName)(Object(Ge.d)(t,e.renderType));Object(ze.recordSessionsWithCountMetric)(o,n)}},ve=function(){e.setShowToolTips(!0)},Me=function(){e.setShowToolTips(!1)},_e=function(t){e.setOverlayMode(!0),Object(ze.recordCountMetric)(De.a.SIDE_PANEL_SELECT_OPTION+t,1),Object(ze.recordSessionsWithCountMetric)(De.a.SIDE_PANEL_SELECT_OPTION+t,1),"TOC"!==t||e.tableOfContents&&!s()(e.tableOfContents)||Object(ze.recordSessionsWithCountMetric)("EmptyTocOpened",1)},Ne=function(){e.setOverlayMode(!1)},Ae=function(t){if(window.parent!==window){G.closeBook();var n=window.sessionStorage.getItem("targetOrigin")||document.referrer,o=window.location!==window.parent.location?n:document.location.href;Ne(),F(!1),e.reinitializeLitb(),t||window.parent.postMessage(Object(ye.d)(ye.a.CLOSE_LITB,{depth:Object(ye.e)()}),o),Object(ye.b)()}},Ie=Object(a.useCallback)((function(e){return!e&&!M}),[M]),Pe=Object(a.useCallback)((function(){return Ie(e.showInlineBuyBox)&&!Qe}),[e.showInlineBuyBox,Ie,Qe]),He=Object(a.useCallback)((function(){return Ie(e.showInlineEndActions)}),[e.showInlineEndActions,Ie]),Fe=Object(a.useCallback)((function(){return!!e.rendererCapabilities&&(e.rendererCapabilities&u.a.Reflowable)>0}),[e.rendererCapabilities]),qe=Object(a.useCallback)((function(){return e.renderType!==ie.a.Stucco||!e.showInlineEndActions}),[e.renderType,e.showInlineEndActions]),ot=function(t){switch(V.selectedOption){case"AA_MENU":return a.createElement(Ee,{key:"aa-body"});case"TOC":return a.createElement(me,{goToPosition:ne,key:"toc"});case"SEARCH":return a.createElement("div",{className:"side-panel-search-container",style:t},a.createElement(Be.a,{renderType:e.renderType,searchBarRef:U,show:!0,key:"search-bar"}),a.createElement(ge.a,{key:"side-panel-search-body",goToPosition:ne,renderType:e.renderType,searchBarRef:U.current}));default:return null}},it=Object(a.useCallback)(oe()((function(t){e.setScrollDelta(t.deltaY)}),50,{leading:!0,trailing:!1}),[e.contentMetadata,e.showInlineEndActions,w,e.showSpinner]),rt=!e.showingCoverImage&&A&&W;return a.createElement(a.Fragment,null,a.createElement("nav",{"aria-label":i("kw-litb-desktop-top-navigation")},f.o()?a.createElement(Re.a,{ariaLabel:i("kw-litb-return-to-store"),interactionManager:e.interactionManager}):null,a.createElement(l.a,{timeout:ae.f,in:rt,classNames:"book-type-tabs"},a.createElement(he.a,null))),a.createElement(l.a,{timeout:ae.f,in:rt,classNames:"litb-content"},a.createElement("div",{className:"litb-content litb-content-desktop","aria-busy":w,style:h.e(o),"aria-hidden":e.showErrorModal},a.createElement("div",{className:ae.j},a.createElement("div",{className:"litb-content-background"},r(je.b.LITB_S2F_TOP_CHROME_BAR_421136)&&function(){var t;nt((function(){return X(Je(Je({},V),{isHidden:!0}))}));var n={marginTop:(e.showInlineBuyBox?0:$e)+"px"};return e.bookOpen?a.createElement(Ue,{title:null===(t=e.litbBook)||void 0===t?void 0:t.title,styles:n,topBarStatus:V,setTopBarStatus:X}):null}(),!r(je.b.LITB_S2F_TOP_CHROME_BAR_421136)&&function(){if(S.current&&C){var t=C.clientHeight-S.current.clientHeight;if(e.setContentHeightWithoutBuyBox(t),qe()){var n=(d=$e,p=t,h="slide-"+(e.showInlineBuyBox?"up":"down"),{top:d+"px",height:p+"px",animationDuration:"200ms",animationIterationCount:1,animationName:h,animationTimingFunction:"ease",animationFillMode:"forwards"}),o=function(){var t,n,o={optionType:"SEARCH",icon:a.createElement(v.a,{key:"search"}),body:a.createElement(ge.a,{key:"side-panel-search-body",goToPosition:ne,renderType:e.renderType,searchBarRef:U.current}),buttonProps:{"aria-controls":"search","aria-label":i("kw-litb-side-panel-search-button-label"),id:"side-panel-search-button"},toolTip:a.createElement(Be.a,{renderType:e.renderType,searchBarRef:U,show:e.showToolTips,key:"search-bar"})},r={optionType:"TOC",icon:a.createElement(m,{key:"toc"}),body:a.createElement(me,{goToPosition:ne,key:"toc"}),buttonProps:{"aria-controls":"table-of-contents","aria-label":i("kw-litb-side-panel-toc-button-label"),id:"side-panel-toc-button"},toolTip:a.createElement(E,{message:i("kw-litb-side-panel-tool-tip-toc-button"),id:"side-panel-toc-menu-button-tooltip",show:e.showToolTips,className:"side-panel-tool-tip"})},c={optionType:"AA_MENU",icon:a.createElement(b.a,{key:"aa"}),body:a.createElement(Ee,{key:"aa-body"}),buttonProps:{"aria-controls":"ember","aria-label":i("kw-litb-side-panel-reading-settings-menu-button-label"),id:"side-panel-aa-button"},toolTip:a.createElement(E,{message:i("kw-litb-side-panel-tool-tip-aa-button"),id:"side-panel-aa-menu-button-tooltip",show:e.showToolTips,className:"side-panel-tool-tip"})},s=[];if(e.rendererCapabilities){var l=e.rendererCapabilities&ae.q||Object(ke.j)();l&&s.push(o);var u=!!(null===(t=e.contentMetadata)||void 0===t?void 0:t.comicBook),d=!!(null===(n=e.contentMetadata)||void 0===n?void 0:n.childrensBook),p=e.rendererCapabilities&ae.s&&!u&&!d;p&&s.push(r);var h=e.rendererCapabilities&ae.a;h&&s.push(c),de(l,p,h)}else de(0,0,0);return s}(),r=o.map((function(e){return e.icon})),c=o.map((function(e){return e.body})),s=o.map((function(e){return e.toolTip})),l=o.map((function(e){return e.optionType})),u=o.map((function(e){return e.buttonProps}));if(o.length&&e.bookOpen)return a.createElement(a.Fragment,null,a.createElement("style",{dangerouslySetInnerHTML:{__html:R}}),a.createElement(a.Suspense,{fallback:a.createElement("div",null)},a.createElement(Ze,{ariaLabel:i("kw-litb-side-panel-aria-label"),buttonProps:u,buttonIcons:r,optionsTypes:l,onHide:Ne,onMouseEnterButtons:ve,onMouseLeaveButtons:Me,onShow:_e,panelBodies:c,ref:T,style:f.n()?void 0:n,toolTips:s})))}}var d,p,h;return null}(),r(je.b.LITB_S2F_TOP_CHROME_BAR_421136)&&(K=e.showInlineBuyBox?0:$e,Q={marginTop:K+"px"},$={height:"calc(100% - "+K+"px)"},ee=null===V.selectedOption?"hidden":"visible",a.createElement("div",null,a.createElement("div",{id:"top-bar-option-side-panel_overlay",className:ee,style:Q,onClick:function(){X(Je(Je({},V),{isHidden:!1,shouldHideAutomatically:!0,selectedOption:null}))},role:"dialog"}),a.createElement("div",{className:["top-bar-option-side-panel",ee].join(" "),style:Q},ot($)))),function(){var t;return z||M||D(!0),(null===(t=e.litbBook)||void 0===t?void 0:t.title)?a.createElement(l.a,{in:Pe(),timeout:ae.f,classNames:"book-title-overlay-container"},a.createElement(ue,{bookTitle:e.litbBook.title})):null}(),function(){var t,n,o=[];return(null===(t=e.litbBook)||void 0===t?void 0:t.productEditionMetadata)&&o.push(a.createElement(Ce.a,{key:"edition"})),e.rendererCapabilities&&e.rendererCapabilities&u.a.ZoomableContent&&o.push(a.createElement(xe.a,{key:"fixed-format"})),o.length?a.createElement(Se.a,{top:(n=r(je.b.LITB_S2F_TOP_CHROME_BAR_421136)?60:0,f.n()||Qe?Pe()?Math.max(50,n):n:$e+n)},o):null}(),a.createElement("main",{id:"litb-renderer",className:function(){var t,n="";return(null===(t=e.contentMetadata)||void 0===t?void 0:t.childrensBook)&&(n="childrens-book-content"),n}(),"aria-label":i("kw-litb-main-content"),ref:B,onWheel:it},a.createElement("div",{role:"presentation",onClick:function(){(e.isOverlayModeOn||e.showDisplayOptions)&&(e.setModalOverlay(!1),e.setOverlayMode(!1),e.setShowDisplayOptions(!1))},className:(J=e.renderType,Z="litb-renderer-click-container",J===ie.a.FixedFormatImage&&(Z+=" litb-renderer-click-container-print"),Z)},function(){if(S.current&&C){var t=C.clientHeight-S.current.clientHeight;e.setContentHeightWithoutBuyBox(t)}return C?a.createElement(fe.a,{ariaBusy:w,bookProvider:e.renderDataPromise,capabilities:e.rendererCapabilities,scrollContainer:C,setAriaBusy:y}):null}(),e.bookOpen?a.createElement(a.Suspense,{fallback:a.createElement("div",null)},a.createElement(tt,{refTagPrefix:"kwrp_li",container:C,className:Ke(e.renderType,e.showInlineEndActions),showGradient:Fe()})):null),e.showSpinner&&a.createElement("div",{id:"kwrpRenderSpinner",className:"kw-loading","aria-hidden":"true"},a.createElement(Oe.a,{className:"litb-spinner"}))),a.createElement(l.a,{in:He(),timeout:ae.f,classNames:"litb-footer"},a.createElement("footer",{role:"contentinfo",id:"litb-footer",className:et(),"aria-label":i("kw-litb-footer-label")},a.createElement(pe,{readingLocationData:e.readingLocationData}))))),a.createElement(l.a,{in:e.showInlineBuyBox,timeout:ae.f,classNames:ae.p},a.createElement("aside",{className:ae.p,"aria-label":i("kw-litb-sidebar-purchase-info"),ref:S},a.createElement(a.Suspense,{fallback:a.createElement("div",null)},a.createElement(Te.a,{refTagPrefix:"kwrp_li",parentClassName:ae.p})))))))}))}}]);